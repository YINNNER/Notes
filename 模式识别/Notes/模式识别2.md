[TOC]

# 4. ç»Ÿè®¡å†³ç­–åˆ†ç±»æ³•

## 4.1 åŸºç¡€

### æ¦‚çŽ‡ä¹˜æ³•å…¬å¼

å¦‚æžœ$P(B)\gt 0$ï¼Œåˆ™è”åˆæ¦‚çŽ‡

$P(AB) = P(B) P(A|B) = P(A)P(B|A) = P(BA)$

### å…¨æ¦‚çŽ‡å…¬å¼

è®¾äº‹ä»¶$A_1,A_2, \cdots , A_n$ï¼Œä¸¤ä¸¤äº’æ–¥ï¼Œä¸”

$\sum^n_{i=1}A_i = \Omega, P(A_i) \gt 0, i=1,2,\cdots,n$

åˆ™å¯¹ä»»ä¸€äº‹ä»¶Bæœ‰ï¼š

$P(B)=\sum^n_{i=1}P(A_i)P(B|A_i)$

### è´å¶æ–¯å…¬å¼

$$
P(A_i|B)=\frac{P(A_i)P(B|A_i)}{\sum^n_{i=1}P(A_i)P(B|A_i)}
$$
**å…ˆéªŒæ¦‚çŽ‡**ï¼šå³$P(A_i)$ï¼Œå³æœªèŽ·å¾—è§‚å¯Ÿç»“æžœå‰ï¼Œå¯¹åŽŸå› Aiåœ¨æœªæ¥äº§ç”Ÿç»“æžœçš„æ¦‚çŽ‡çš„è®¤å®šã€‚

**åŽéªŒæ¦‚çŽ‡**ï¼šå³$P(A_i|B)$ï¼ŒèŽ·å¾—è§‚å¯Ÿç»“æžœBä¹‹åŽï¼Œç»“åˆå…ˆéªŒçŸ¥è¯†ï¼Œè®¡ç®—å‡ºçš„å¯¹ç»“æžœBæ˜¯ç”±åŽŸå› Aiå¼•èµ·çš„æ¦‚çŽ‡ã€‚

#### è´å¶æ–¯å…¬å¼çš„å¯†åº¦å‡½æ•°å½¢å¼

$$
\pi(\theta|x)=\frac{h(x,\theta)}{m(x)}=\frac{p(x|\theta)\pi(\theta)}{\int p(x|\theta)\pi(\theta)d\theta}
$$

- è¿™ä¸ªâ€œåœ¨è§‚å¯Ÿåˆ°xçš„æ¡ä»¶ä¸‹$\theta $ çš„æ¡ä»¶åˆ†å¸ƒâ€ç§°ä¸º $\theta$ çš„åŽéªŒåˆ†å¸ƒ,å®ƒé›†ä¸­äº†æ€»ä½“ã€æ ·æœ¬å’Œå…ˆéªŒä¸­æœ‰å…³$\theta $ çš„ä¸€åˆ‡ä¿¡æ¯,è€Œåˆæ˜¯æŽ’é™¤ä¸€åˆ‡ä¸Ž$\theta $ æ— å…³çš„ä¿¡æ¯ä¹‹åŽå¾—åˆ°çš„ç»“æžœã€‚ 
- åŽéªŒåˆ†å¸ƒ$\pi(\theta| x )$çš„è®¡ç®—å…¬å¼å°±æ˜¯ç”¨å¯†åº¦å‡½æ•°è¡¨ç¤ºçš„è´å¶æ–¯å…¬å¼ã€‚å®ƒæ˜¯ç”¨æ€»ä½“å’Œæ ·æœ¬å¯¹å…ˆéªŒåˆ†å¸ƒ$\pi(\theta)$ä½œè°ƒæ•´çš„ç»“æžœï¼Œè´å¶æ–¯ç»Ÿè®¡çš„ä¸€åˆ‡æŽ¨æ–­éƒ½åŸºäºŽåŽéªŒåˆ†å¸ƒè¿›è¡Œã€‚ 

### æ¨¡å¼è¯†åˆ«ä¸­ä¸‰ä¸ªæ¦‚çŽ‡

è®¾éšæœºæ ·æœ¬å‘é‡X ï¼Œç›¸å…³çš„ä¸‰ä¸ªæ¦‚çŽ‡: 

1. **å…ˆéªŒæ¦‚çŽ‡P(Ï‰i)**ï¼šæ ¹æ®ä»¥å‰çš„çŸ¥è¯†å’Œç»éªŒå¾—å‡ºçš„ã€æœªæ¥æ ·æœ¬Xå¯èƒ½å±žäºŽÏ‰iç±»çš„æ¦‚çŽ‡â€”â€”å±žäº‹å…ˆçŒœæµ‹ï¼Œæ•…ç§°å…ˆéªŒæ¦‚çŽ‡ã€‚

2. **åŽéªŒæ¦‚çŽ‡P(Ï‰i|X)**ï¼šæŒ‡èŽ·å¾—æ ·æœ¬XåŽï¼Œæ ¹æ®æ ·æœ¬æä¾›çš„ä¿¡æ¯è®¡ç®—å‡ºçš„ã€å½“å‰Xå¯èƒ½å±žäºŽÏ‰iç±»çš„æ¦‚çŽ‡ã€‚è™½ç„¶ä»ç„¶æ˜¯æ¦‚çŽ‡æ„ä¹‰ä¸Šçš„äº‹åŽçŒœæµ‹ï¼Œä½†è¿™æ˜¯åœ¨å¾—åˆ°æ ·æœ¬XåŽçš„æ¦‚çŽ‡ï¼Œæ•…ç§°ä¸ºåŽéªŒæ¦‚çŽ‡ã€‚ 

3. **æ¡ä»¶æ¦‚çŽ‡P(X |Ï‰i)**ï¼šå¯¹å±žäºŽÏ‰iç±»çš„æ ·æœ¬ï¼Œå…¶å–å€¼ä¸ºXçš„æ¦‚çŽ‡ã€‚ä¾‹:å¯¹ä¸€æ‰¹å¾—ç—…æ‚£è€…è¿›è¡ŒåŒ–éªŒï¼Œç»“æžœä¸ºé˜³æ€§çš„æ¦‚çŽ‡ä¸º95%ï¼Œ Ï‰1ä»£è¡¨äººç¾¤å¾—ç—…ï¼Œ åˆ™â€œæ‚£ç—…è€…(X âˆˆÏ‰1)çš„åŒ–éªŒç»“æžœXä¸ºé˜³æ€§è¿™ä¸€äº‹ä»¶çš„æ¦‚çŽ‡â€å¯è¡¨ç¤ºä¸ºï¼š $P(X=é˜³|\omega_1)=0.95$ ã€‚

- ä»ŠåŽçš„åˆ†ç±»ä¸­å¸¸ç”¨åˆ°**ç±»æ¦‚çŽ‡å¯†åº¦$P(X | Ï‰_i)$**ï¼šÏ‰iç±»çš„æ¡ä»¶æ¦‚çŽ‡å¯†åº¦å‡½æ•°ã€ Ï‰iç±»æ¨¡å¼çš„æ€»ä½“åˆ†å¸ƒï¼Œé€šå¸¸ä¹Ÿç§°ä¸º**$Ï‰_i$çš„ä¼¼ç„¶å‡½æ•°**ã€‚ 

#### ä¸‰è€…å…³ç³»

$P(\omega_i|X) = \frac{P(X|\omega_i)P(\omega_i)}{P(X)} = \frac{P(X|\omega_i)P(\omega_i)}{\sum^M_{i=1}P(X|\omega_i)P(\omega_i)}$

M: ç±»åˆ«æ•°

P(X):è¾¹ç¼˜å¯†åº¦ï¼Œä¸Žð‘ƒ(ðœ”ð‘–) çš„é€‰æ‹©æœ‰å…³ï¼Œå› æ­¤ä¸èƒ½è§†ä¸ºç‹¬ç«‹çš„ï¼Œè™½ç„¶è®°å·æ²¡æœ‰è¡¨ç¤ºè¿™ç‚¹!

## 4.2 è´å¶æ–¯å†³ç­–

### 4.2.1 æœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–

#### å†³ç­–è§„åˆ™

> è®¾æœ‰Mç±»æ¨¡å¼ï¼Œè‹¥$P(\omega_i|X)=max{P(\omega_i|X)},\ j=1,2,...,M$ï¼Œåˆ™$X\in \omega_i$ç±»

- $P(\omega_i|X)$å¯ç”¨è´å¶æ–¯å…¬å¼æ±‚å¾—ã€‚

- è´å¶æ–¯å…¬å¼ï¼š$P(\omega_i|X) = \frac{P(X|\omega_i)P(\omega_i)}{P(X)} = \frac{P(X|\omega_i)P(\omega_i)}{\sum^M_{i=1}P(X|\omega_i)P(\omega_i)}$ï¼Œå¯çŸ¥ï¼Œåˆ†æ¯ä¸Žiæ— å…³ï¼Œå³ä¸Žåˆ†ç±»æ— å…³ï¼Œæ•…åˆ†ç±»è§„åˆ™åˆå¯è¡¨ç¤ºä¸ºï¼š

  > è‹¥$P(X|\omega_i)P(\omega_i)=max\{P(X|\omega_j)P(\omega_j)\}, j=1,2,\cdots,M$ï¼Œåˆ™$X\in \omega_i$ç±»ã€‚ 

##### å¯¹ä¸¤ç±»é—®é¢˜

- è‹¥$p(X|\omega_1)P(\omega_1)>p(X|\omega_2)P(\omega_2)$ï¼Œåˆ™$X\in\omega_1$
- è‹¥$p(X|\omega_1)P(\omega_1)<p(X|\omega_2)P(\omega_2)$ï¼Œåˆ™$X\in\omega_2$

å³ï¼š
$$
l_{12}(X)=\frac{p(X|\omega_1)}{p(X|\omega_2)} \begin{matrix}
> \\
<
\end{matrix}
\frac{P(\omega_2)}{P(\omega_1)}ï¼Œåˆ™X\in 
\left\{
\begin{aligned}
\omega_1 \\
\omega_2
\end{aligned}
\right.
$$
å¯¹æ•°å½¢å¼ï¼š
$$
h(X)=lnl_{12}(X)=lnp(X|\omega_1)-lnp(X|\omega_2)
\begin{matrix}
> \\
<
\end{matrix}
ln\frac{P(\omega_2)}{P(\omega_1)},\ åˆ™X\in 
\left\{
\begin{aligned}
\omega_1 \\
\omega_2
\end{aligned}
\right.
$$

- $l_{12}$ç§°ä¸º**ä¼¼ç„¶æ¯”**ï¼Œ$\frac{P(\omega_2)}{P(\omega_1)}$ä¸º**ä¼¼ç„¶æ¯”é˜™å€¼**ã€‚

### 4.2.2 æœ€å°é£Žé™©è´å¶æ–¯å†³ç­–

#### 1. é£Žé™©æ¦‚å¿µ

- ä¸åŒçš„é”™åˆ¤é€ æˆçš„æŸå¤±ä¸åŒï¼Œå› æ­¤é£Žé™©ä¸åŒï¼Œä¸¤è€…ç´§å¯†ç›¸è¿ž ã€‚ 
- è€ƒè™‘åˆ°å¯¹æŸä¸€ç±»çš„é”™åˆ¤è¦æ¯”å¯¹å¦ä¸€ç±»çš„é”™åˆ¤æ›´ä¸ºå…³é”®ï¼Œ æŠŠæœ€å°é”™è¯¯çŽ‡çš„è´å¶æ–¯åˆ¤å†³åšä¸€äº›ä¿®æ”¹ï¼Œæå‡ºäº†â€œæ¡ä»¶é£Žé™©â€ çš„æ¦‚å¿µã€‚ 

##### åŸºæœ¬æ€æƒ³

ä»¥å„ç§é”™è¯¯åˆ†ç±»æ‰€é€ æˆçš„**æ¡ä»¶é£Žé™©ï¼ˆåŽéªŒé£Žé™©ï¼‰**æœ€å°ä¸ºè§„åˆ™ï¼Œè¿›è¡Œåˆ†ç±»å†³ç­–ã€‚

#### 2. å†³ç­–è§„åˆ™

$$
r_i ä¸ºXè¢«åˆ¤å†³ä¸ºæ¯ä¸€ç±»çš„æ¡ä»¶å¹³å‡é£Žé™©ï¼Œåˆ™å†³ç­–è§„åˆ™ï¼š \\
è‹¥r_k(X)=min\{r_i(X),\ i=1,...,M\}\ \ åˆ™X\in \omega_k
$$

å…¶ä¸­ï¼š
$$
r_i(X)=\sum^M_{j=1}L_{ij}(X)P(\omega_j|X)
$$

- iï¼šåˆ†ç±»åˆ¤å†³åŽæŒ‡å®šçš„ç±»å·ã€‚

- jï¼šæ ·æœ¬å®žé™…å±žäºŽçš„ç±»åˆ«å·ã€‚

- $L_{ij}$ï¼šå°†è‡ªç„¶å±žæ€§æ˜¯$\omega_j$ç±»çš„æ ·æœ¬å†³ç­–ä¸º$\omega_i$ç±»æ—¶çš„æ˜¯éžä»£ä»·ï¼Œå³**æŸå¤±å‡½æ•°**ã€‚

  - æ³¨æ„ä¸‹æ ‡é¡ºåºåŠå…¶å«ä¹‰ï¼š$L_{i \leftarrow j}$

  - $$
    L_{ij}(X)= 
    \left\{
    \begin{aligned}
    &0æˆ–è´Ÿå€¼ï¼Œ i=jæ—¶\\
    &æ­£å€¼ï¼Œi \ne j æ—¶
    \end{aligned}
    \right.
    $$








#####  (1) å¤šç±»æƒ…å†µ

è®¾æœ‰Mç±»ï¼Œå¯¹äºŽä»»ä¸€Xå¯¹åº”Mä¸ªæ¡ä»¶é£Žé™©ï¼š
$$
r_i(X)=\sum^M_{j=1}L_{ij}(X)P(\omega_j|X), \ i=1,2,...,M
$$
ç”¨å…ˆéªŒæ¦‚çŽ‡å’Œæ¡ä»¶æ¦‚çŽ‡çš„å½¢å¼ï¼šï¼ˆçœåŽ»1/P(X)ï¼Œå› å…¶å¯¹æ‰€æœ‰ç±»åˆ«ä¸€æ ·ï¼Œä¸æä¾›åˆ†ç±»ä¿¡æ¯ã€‚ï¼‰
$$
r_i(X)=\sum^M_{j=1}L_{ij}(X)P(X|\omega_j)P(\omega_j), \ i=1,2,...,M
$$
å†³ç­–è§„åˆ™ï¼š
$$
è‹¥r_k(X)<r_i(X), \ i=1,2,...,M;\ i\ne k,åˆ™X\in \omega_k
$$

##### (2) ä¸¤ç±»æƒ…å†µ

$$
\begin{aligned}
& å½“æ ·æœ¬Xè¢«åˆ¤ä¸º\omega_1 ç±»æ—¶ï¼š\\
& \quad r_1(X)=L_{11}p(X|\omega_1)P(\omega_1)+L_{12}p(X|\omega_2)P(\omega_2) \\
& å½“Xè¢«åˆ¤ä¸º\omega_2ç±»æ—¶ï¼š\\
& \quad r_2(X)=L_{21}p(X|\omega_1)P(\omega_1)+L_{22}p(X|\omega_2)P(\omega_2) \\
& å†³ç­–è§„åˆ™ï¼š\\
& \quad è‹¥r_1(X)<r_2(X) \quad åˆ™X\in \omega_1 \\
& \quad è‹¥r_1(X)>r_2(X) \quad åˆ™X\in \omega_2
\end{aligned}
$$

å®šä¹‰ï¼š
$$
l_{12}(X)=\frac{p(X|\omega_1)}{p(X|\omega_2)}ï¼Œç§°ä¸ºä¼¼ç„¶æ¯” \\
\theta_{12}=\frac{(L_{12}-L_{22})P(\omega_2)}{(L_{21}-L_{11})P(\omega_1)}ï¼Œç§°ä¸ºé˜ˆå€¼
$$
**åˆ¤åˆ«æ­¥éª¤ï¼š**

1. å®šä¹‰æŸå¤±å‡½æ•°$L_{ij}$

2. è®¡ç®—ä¼¼ç„¶æ¯”é˜ˆå€¼$\theta_{12}$

3. è®¡ç®—ä¼¼ç„¶æ¯”$l_{12}(X)$

4. è‹¥$l_{12}(X)>\theta_{12}$ï¼Œåˆ™$X\in \omega_1$

   è‹¥$l_{12}(X)<\theta_{12}$ï¼Œåˆ™$X\in \omega_2$

   è‹¥$l_{12}(X)=\theta_{12}$ï¼Œä»»æ„åˆ¤å†³



#### 3. (0-1)æŸå¤±æœ€å°é£Žé™©è´å¶æ–¯å†³ç­–

å³æŸå¤±å‡½æ•°ä¸ºï¼š$L_{ii}=0,\ \ L_{ij} = 1,\ i\ne j$

##### å¤šç±»æƒ…å†µ

ç»è¿‡æŽ¨å¯¼å¯å¾—ä»¥ä¸‹ç­‰ä»·å½¢å¼ã€‚

- **åˆ¤å†³å‡½æ•°**çš„ç­‰ä»·å½¢å¼ï¼š$d_i(X)=p(X|\omega_i)P(\omega_i),i=1,2,...,M$

- **å†³ç­–è§„åˆ™**çš„ç­‰ä»·å½¢å¼ï¼š

$$
è‹¥d_k(X)>d_i(X),i=1,2,...,M,i\ne k \quad ,åˆ™X\in \omega_k
$$

##### ä¸¤ç±»æƒ…å†µ

ä»¥å¤šç±»æƒ…å†µç±»æŽ¨ã€‚

### 4.2.3 æ­£æ€åˆ†å¸ƒæ¨¡å¼çš„è´å¶æ–¯å†³ç­–

è®¸å¤šå®žé™…çš„æ•°æ®é›†ï¼šå‡å€¼é™„è¿‘åˆ†å¸ƒè¾ƒå¤šçš„æ ·æœ¬ï¼›è·å‡å€¼ç‚¹è¶Šè¿œï¼Œæ ·æœ¬åˆ†å¸ƒè¶Šå°‘ã€‚æ­¤æ—¶æ­£æ€åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒ)æ˜¯ä¸€ç§åˆç†çš„è¿‘ä¼¼ã€‚

å³**ç±»å¯†åº¦å‡½æ•°$P(X|\omega_i)$æœä»Žæ­£æ€åˆ†å¸ƒ**çš„æƒ…å†µï¼Œæ­¤æ—¶ä¸ç”¨æ±‚å‡ºå…¶å…·ä½“å½¢å¼ï¼Œåªéœ€çŸ¥é“å‡å€¼å‘é‡Mã€åæ–¹å·®çŸ©é˜µCä¸¤ä¸ªå‚æ•°å³å¯ã€‚

#### 1. ç›¸å…³çŸ¥è¯†

> å¤šå˜é‡(nç»´)æ­£æ€éšæœºå‘é‡
>
> å¯†åº¦å‡½æ•°å®šä¹‰ä¸ºï¼š
>
> $p(X|\omega_i)=\frac{1}{(2\pi)^{n/2}|C_i|^{1/2}}exp\{-\frac{1}{2}(X-M_i)^TC_i^{-1}(X-M_i)\}, \quad i=1,2,...,M$
>
> å¤šç»´æ­£æ€å¯†åº¦å‡½æ•°å®Œå…¨ç”±å®ƒçš„å‡å€¼Må’Œåæ–¹å·®çŸ©é˜µCæ‰€ç¡®å®šï¼Œç®€è®°ä¸ºï¼š$p(X)\sim N(M,C)$ã€‚

#### 2. æ­£æ€åˆ†å¸ƒçš„æœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–è§„åˆ™

##### (1)å¤šç±»æƒ…å†µ

å…·æœ‰**M**ç§æ¨¡å¼ç±»åˆ«çš„**å¤šå˜é‡**æ­£æ€å¯†åº¦å‡½æ•°ä¸ºï¼š
$$
p(X|\omega_i)=\frac{1}{(2\pi)^{n/2}|C_i|^{1/2}}exp\{-\frac{1}{2}(X-M_i)^TC_i^{-1}(X-M_i)\}, \quad i=1,2,...,M
$$
å®šä¹‰ï¼š

å‡å€¼å‘é‡ï¼š$M_i=E_i[X]$ï¼ˆè¡¨æ˜Žäº†åŒºåŸŸä¸­å¿ƒçš„ä½ç½®ï¼‰

åæ–¹å·®çŸ©é˜µï¼š$C_i=E_i[(X-M_i)(X-M_i)^T]$ï¼ˆåæ˜ æ ·æœ¬åˆ†å¸ƒåŒºåŸŸçš„å½¢çŠ¶ï¼‰

**åˆ¤å†³åˆ™å¸¦å…¥æœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–çš„åˆ¤åˆ«å‡½æ•°ä¸­ï¼š**

æœ€å°é”™è¯¯çŽ‡Bayeså†³ç­–ä¸­ï¼ŒÏ‰iç±»çš„åˆ¤åˆ«å‡½æ•°ä¸º $P(X |\omega_i )P(\omega_i )$ï¼Œå¯¹æ­£æ€å¯†åº¦å‡½æ•°ï¼Œä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œå–å¯¹æ•°ï¼š
$$
\begin{align} 
&ln[P(X |\omega_i )P(\omega_i )] = ln[P(X |\omega_i )]+ln[P(\omega_i )] \\
&= lnP(\omega_i)-\frac{n}{2}ln2\pi-\frac{1}{2}ln|C_i|-\frac{1}{2}\{(X-M_i)^TC_i^{-1}(X-M_i)\}
\end{align}
\\
åŽ»æŽ‰ä¸Žiæ— å…³çš„é¡¹ï¼Œå¾—åˆ°æ­£æ€åˆ†å¸ƒçš„æœ€å°é”™è¯¯çŽ‡Bayeså†³ç­–çš„åˆ¤åˆ«å‡½æ•°ï¼š\\
d_i(X) = lnP(\omega_i)-\frac{1}{2}ln|C_i|-\frac{1}{2}\{(X-M_i)^TC_i^{-1}(X-M_i)\}, i = 1,2,\cdots,M
$$

- åˆ¤åˆ«å‡½æ•°ï¼š$d_i(X) = lnP(\omega_i)-\frac{1}{2}ln|C_i|-\frac{1}{2}\{(X-M_i)^TC_i^{-1}(X-M_i)\}, i = 1,2,\cdots,M$
- åˆ¤åˆ«è§„åˆ™åŒå‰ï¼šè‹¥$d_j(X)>d_i(X),i=1,2,...,M,i\ne j \quad ,åˆ™X\in \omega_j$ã€‚
- $d_i(X)$ä¸ºè¶…äºŒæ¬¡æ›²é¢ã€‚å¯è§å¯¹æ­£æ€åˆ†å¸ƒæ¨¡å¼çš„Bayesåˆ†ç±»å™¨ï¼Œä¸¤ç±»æ¨¡å¼ä¹‹é—´ç”¨ä¸€ä¸ªäºŒæ¬¡åˆ¤åˆ«ç•Œé¢åˆ†å¼€ï¼Œå°±å¯ä»¥æ±‚å¾—æœ€ä¼˜çš„åˆ†ç±»æ•ˆæžœã€‚

##### ä¸¤ç±»é—®é¢˜

åˆ¤åˆ«å‡½æ•°ï¼š
$$
d_i(X)=lnP(\omega_i)-\frac{1}{2}ln|C_i|-\frac{1}{2}\{(X-M_i)^TC^{-1}_i(X-M_i)\}
$$
å†³ç­–è§„åˆ™ï¼š
$$
è‹¥d_1(X)-d_2(X)
\left\{
\begin{aligned}
>0,\quad åˆ™X\in\omega_1 \\
<0,\quad åˆ™X\in \omega_2
\end{aligned}
\right.
$$

å…·ä½“åˆ†ä¸º$C_1 \ne C_2 \,å’Œ\, C_1 = C_2 = C \,å’Œ\, C_1 = C_2 = I$ ä¸‰ç§æƒ…å†µã€‚

## 4.3 è´å¶æ–¯åˆ†ç±»å™¨çš„é”™è¯¯çŽ‡

### 4.3.1 æ¦‚å¿µ

- é”™è¯¯çŽ‡ï¼šå°†åº”å±žäºŽæŸä¸€ç±»çš„æ¨¡å¼é”™åˆ†åˆ°å…¶ä»–ç±»ä¸­çš„æ¦‚çŽ‡ã€‚æ˜¯è¡¡é‡åˆ†ç±»å™¨æ€§èƒ½ä¼˜åŠ£çš„é‡è¦å‚æ•°ã€‚
  $$
  P(e)=\int^\infty_{-\infty}P(e|X)p(X)dX \\
  å…¶ä¸­ï¼ŒX=[x_1,...,x_n]^T,P(e|X)æ˜¯Xçš„æ¡ä»¶é”™è¯¯æ¦‚çŽ‡
  $$

- é”™è¯¯çŽ‡è®¡ç®—æˆ–ä¼°è®¡æ–¹æ³•ï¼š

  - æŒ‰ç†è®ºå…¬å¼è®¡ç®—
  - è®¡ç®—é”™è¯¯çŽ‡ä¸Šç•Œ
  - å®žéªŒä¼°è®¡

### 4.3.2 é”™è¯¯çŽ‡åˆ†æž

#### ä¸¤ç±»é—®é¢˜çš„é”™è¯¯çŽ‡

æœ‰ä¸¤ç§é”™è¯¯ï¼š

1. å°†æ¥è‡ªw1ç±»çš„æ¨¡å¼é”™åˆ†åˆ°R2ä¸­åŽ»
2. å°†æ¥è‡ªw2ç±»çš„æ¨¡å¼é”™åˆ†åˆ°R1ä¸­åŽ»

é”™è¯¯çŽ‡ä¸ºä¸¤ç§é”™è¯¯ä¹‹å’Œï¼š
$$
P(e)=\int_{R_2}P_1(e|X)p(X)dX+\int_{R_1}P_2(e|X)p(X)dX
$$

##### æœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–è§„åˆ™

ç”¨åŽéªŒæ¦‚çŽ‡å¯†åº¦è¡¨ç¤ºä¸º
$$
\left\{
\begin{aligned}
&è‹¥\quad P(\omega_1|X)>P(\omega_2|X),\quad åˆ™X\in \omega_1 \\
&è‹¥\quad P(\omega_1|X)<P(\omega_2|X),\quad åˆ™X\in \omega_2
\end{aligned}
\right.
$$
åˆ¤åˆ«ç•Œé¢ä¸ºï¼š
$$
P(\omega_1|X)=P(\omega_2|X) \\
æˆ–\quad p(X|\omega_1)P(\omega_1)=p(X|\omega_2)P(\omega_2)
$$

#### å¤šç±»æƒ…å†µé”™è¯¯çŽ‡

æ€»é”™è¯¯çŽ‡
$$
P(e)=\sum^M_{i=1}\sum^M_{j=1}\int_{R_i}p(X|\omega_j)P(\omega_j)dX
$$
æ­£ç¡®åˆ†ç±»æ¦‚çŽ‡
$$
P(c)=\sum^M_{i=1}\int_{R_i}p(X|\omega_i)P(\omega_i)dX
$$

### 4.3.3 æ­£æ€åˆ†å¸ƒè´å¶æ–¯å†³ç­–çš„é”™è¯¯çŽ‡è®¡ç®—

#### æ­£æ€åˆ†å¸ƒçš„å¯¹æ•°ä¼¼ç„¶æ¯”

å¯¹æ•°ä¼¼ç„¶æ¯”å†³ç­–è§„åˆ™ï¼š
$$
è‹¥h(X)=ln\ l_{12}(X)=ln\ p(X|\omega_1)-ln\ p(X|\omega_2)
\begin{matrix}
> \\
<
\end{matrix}
ln\frac{P(\omega_2)}{P(\omega_1)}
\\
åˆ™X\in 
\left\{
\begin{aligned}
\omega_1 \\
\omega_2
\end{aligned}
\right.
$$

$$
ä»¤t=ln\ \frac{P(\omega_2)}{P(\omega_1)}ï¼Œæœ‰\\
è‹¥h(X)
\begin{matrix}
> \\
<
\end{matrix}t,\quad åˆ™X\in 
\left\{
\begin{aligned}
\omega_1 \\
\omega_2
\end{aligned}
\right.
$$



ç”±æ­£æ€åˆ†å¸ƒæ¦‚çŽ‡å¯†åº¦å‡½æ•°ï¼Œæœ‰ï¼š
$$
h(X)=-\frac{1}{2}(X-M_1)^TC^{-1}(X-M_1)+\frac{1}{2}(X-M_2)^TC^{-1}(X-M_2)
$$

#### å¯¹æ•°ä¼¼ç„¶æ¯”çš„æ¦‚çŽ‡åˆ†å¸ƒ

å‡å€¼ï¼š
$$
\mu_1=E\{h(X)\}=\frac{1}{2}(M_1-M_2)^TC^{-1}(M_1-M_2)
$$
æ–¹å·®ï¼š
$$
\sigma_1^2=(M_1-M_2)^TC^{-1}(M_1-M_2)
$$

#### æ­£æ€åˆ†å¸ƒæœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–çš„é”™è¯¯çŽ‡

ä¸¤ç±»é—®é¢˜æœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–çš„é”™è¯¯çŽ‡ï¼š
$$
P(e)=P(\omega_1)\int^t_{-\infty}\frac{1}{\sqrt{2\pi}r_{12}}exp[-\frac{(h-\frac{1}{2}r_{12}^2)^2}{2r_{12}^2}]dh\\
+P(\omega_2)\int^{\infty}_t\frac{1}{\sqrt{2\pi}r_{12}}exp[-\frac{(h+\frac{1}{2}r_{12}^2)^2}{2r_{12}^2}]dh
$$

### 4.3.4 é”™è¯¯çŽ‡çš„ä¼°è®¡

#### å·²è®¾è®¡å¥½åˆ†ç±»å™¨æ—¶é”™è¯¯çŽ‡çš„ä¼°è®¡

1. å…ˆéªŒæ¦‚çŽ‡æœªçŸ¥â€”â€”éšæœºæŠ½æ ·
   $$
   \widehat{\varepsilon}=\frac{k}{N} \\
   Nï¼šéšæœºæŠ½å–çš„æ ·æœ¬æ•° \\
   kï¼šé”™åˆ†æ ·æœ¬æ•°
   $$

2. å…ˆéªŒæ¦‚çŽ‡å·²çŸ¥â€”â€”é€‰æ‹©æ€§æŠ½æ ·

   åˆ†åˆ«ä»Ž$\omega_1$ç±»å’Œ$\omega_2$ç±»ä¸­æŠ½å–å‡º$N_1$$N_2$ä¸ªæ ·æœ¬ï¼Œ
   $$
   N_1=P(\omega_1)N \quad\quad N_2=P(\omega_2)N
   $$
   ç”¨$N_1+N_2=N$ä¸ªæ ·æœ¬å¯¹è®¾è®¡å¥½çš„åˆ†ç±»å™¨ä½œåˆ†ç±»æ£€éªŒã€‚

   ![1](images/4-3-4.png)



#### æœªè®¾è®¡å¥½åˆ†ç±»å™¨æ—¶é”™è¯¯çŽ‡çš„ä¼°è®¡

ï¼ˆæˆ‘è§‰å¾—ä¸é‡è¦å§ï¼‰

## 4.4 è€æ›¼-çš®å°”é€Šå†³ç­–

- åŸºæœ¬æ€æƒ³ï¼šé™åˆ¶æŸä¸€ç±»é”™è¯¯çŽ‡ä¸ºä¸€ä¸ªç¡®å®šå€¼ï¼Œæ±‚å–ä½¿å¾—å¦ä¸€ç±»é”™è¯¯çŽ‡æœ€å°çš„åˆ¤å†³è§„åˆ™ä¸Žåˆ¤å†³é˜ˆå€¼

- ä¸¤ç±»é”™è¯¯çŽ‡ï¼š
  $$
  P_1(e)=\int_{R_2}p(X|\omega_1)dX \;\; \omega_1ç±»æ¨¡å¼è¢«è¯¯åˆ¤ä¸º\omega_2ç±»çš„é”™è¯¯çŽ‡\\
  P_2(e)=\int_{R_1}p(X|\omega_2)dX \;\; \omega_2ç±»æ¨¡å¼è¢«è¯¯åˆ¤ä¸º\omega_1ç±»çš„é”™è¯¯çŽ‡
  $$

- **è€æ›¼-çš®å°”é€Šå†³ç­–å‡ºå‘ç‚¹ï¼š**åœ¨$P_2(e)$ç­‰äºŽå¸¸æ•°çš„æ¡ä»¶ä¸‹ï¼Œä½¿$P_1(e)$ä¸ºæœ€å°ï¼Œä»¥æ­¤ç¡®å®šé˜ˆå€¼t

### åˆ¤åˆ«å¼

- è¾…åŠ©å‡½æ•°ï¼š$Q=P_1(e)+\mu P_2(e)$ï¼Œå¼ä¸­ï¼Œ$\mu$ä¸ºå¾…å®šå¸¸æ•°ï¼Œ$P_2(e)$ä¸ºå¸¸æ•°

- **å†³ç­–è§„åˆ™**ï¼š
  $$
  è‹¥\frac{p(X|\omega_1)}{p(X|\omega_2)}
  \begin{matrix}
  > \\
  <
  \end{matrix}
  \mu ,åˆ™X\in
  \left\{
  \begin{aligned}
  \omega_1 \\
  \omega_2 
  \end{aligned}
  \right.
  $$

- å½“$\frac{p(X|\omega_1)}{p(X|\omega_2)}=\mu$æ—¶ï¼Œæ­¤æ—¶çš„Xä¸º**æ¨¡å¼çš„åˆ¤å†³é˜ˆå€¼t**ï¼Œæ˜¯**ä¼¼ç„¶æ¯”é˜ˆå€¼$\mu$**çš„å‡½æ•°$X=t(\mu)$ï¼Œæ­¤å³ä¸¤ç±»æ¨¡å¼çš„**åˆ¤åˆ«ç•Œé¢**

- æ±‚è§£$\mu$ å€¼ï¼š
  $$
  P_2(e)=\int^{t(\mu)}_{-\infty}p(X|\omega_2)dX
  $$



### è®¡ç®—æ­¥éª¤

1. æ±‚ç±»æ¦‚çŽ‡å¯†åº¦
   $$
   å¦‚æ­£æ€åˆ†å¸ƒçš„ç±»æ¦‚çŽ‡å¯†åº¦å‡½æ•°ï¼š\\
   p(X|\omega_i)=\frac{1}{(2\pi)^{n/2}|C_i|^{1/2}}exp\{-\frac{1}{2}(X-M_i)^TC^{-1}_i(X-M_i)\}
   $$

2. æ±‚ä¼¼ç„¶æ¯”
   $$
   \frac{p(X|\omega_1)}{p(X|\omega_2)}
   $$

3. æ±‚åˆ¤åˆ«å¼

   å†³ç­–è§„åˆ™ï¼š
   $$
   è‹¥ ä¼¼ç„¶æ¯”
   \begin{matrix}
   > \\
   <
   \end{matrix}
   \mu ï¼Œåˆ™X\in 
   \left\{
   \begin{aligned}
   \omega_1 \\
   \omega_2
   \end{aligned}
   \right.
   $$

4. æ±‚ä¼¼ç„¶æ¯”é˜ˆå€¼$\mu$
   $$
   P_2(e)=\int_{R_1}p(X|\omega_2)dX
   $$



### ç ”ç©¶ç®—æ³•çš„ä¸‰ç§æ€è·¯

1. ä½¿æ€»é”™è¯¯çŽ‡æœ€å°ï¼šæœ€å°é”™è¯¯çŽ‡è´å¶æ–¯å†³ç­–
2. ä½¿é£Žé™©ï¼ˆé”™è¯¯å¼•èµ·çš„å¹³å‡æŸå¤±ï¼‰æœ€å°ï¼š
   - æœ€å°åŽéªŒé£Žé™©è´å¶æ–¯å†³ç­–
   - ï¼ˆ0-1ï¼‰æŸå¤±æœ€å°é£Žé™©è´å¶æ–¯å†³ç­–
3. é™åˆ¶ä¸€ç±»é”™è¯¯æ¦‚çŽ‡ï¼Œè¿½æ±‚å¦ä¸€ç±»é”™è¯¯çŽ‡æœ€å°ï¼šè€æ›¼-çš®å°”é€Šå†³ç­–

## 4.5 æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„å‚æ•°ä¼°è®¡æ–¹æ³•

- å½“ç±»æ¨¡å¼çš„æ¦‚çŽ‡å¯†åº¦å‡½æ•°$p(X|\omega_i)$æ˜¯æœªçŸ¥çš„æ—¶å€™ï¼Œéœ€è¦ä»Žå·²çŸ¥æ ·æœ¬ä¸­å­¦ä¹ ï¼Œè¿›è¡Œä¼°è®¡
- æ¦‚çŽ‡å¯†åº¦çš„ä¸¤ç±»ä¼°è®¡æ–¹æ³•ï¼š
  - å‚æ•°ä¼°è®¡æ–¹æ³•ï¼š**å·²çŸ¥æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„å½¢å¼ï¼Œè€Œå‡½æ•°çš„æœ‰å…³å‚æ•°æœªçŸ¥**ï¼Œé€šè¿‡ä¼°è®¡å‚æ•°æ¥ä¼°è®¡æ¦‚çŽ‡å¯†åº¦å‡½æ•°
    - ä¸»è¦çš„å‚æ•°ä¼°è®¡æ–¹æ³•ï¼š**æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€è´å¶æ–¯ä¼°è®¡**
  - éžå‚æ•°ä¼°è®¡æ–¹æ³•ï¼š**æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„å½¢å¼æœªçŸ¥**ï¼Œç›´æŽ¥ä¼°è®¡æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„æ–¹æ³•

### 4.5.1 æœ€å¤§ä¼¼ç„¶ä¼°è®¡

#### ä¼¼ç„¶å‡½æ•°

â€‹	ä»Ž$\omega_i$ç±»ä¸­ç‹¬ç«‹åœ°æŠ½å–Nä¸ªæ ·æœ¬ï¼š$X^N=\{X_1,X_2,...,X_N\}$ï¼Œç§°è¿™Nä¸ªæ ·æœ¬çš„è”åˆæ¦‚çŽ‡å¯†åº¦å‡½æ•°$p(X^N|\theta)$ä¸ºç›¸å¯¹äºŽæ ·æœ¬é›†$X^N$çš„$\theta$çš„ä¼¼ç„¶å‡½æ•°ã€‚
$$
p(X^N|\theta)=p(X_1,X_2,...,X_N|\theta)=\prod^N_{k=1}p(X_k|\theta) \\
â€”â€”åœ¨å‚æ•°\theta ä¸‹è§‚æµ‹åˆ°çš„æ ·æœ¬é›†X^Nçš„æ¦‚çŽ‡ï¼ˆè”åˆåˆ†å¸ƒï¼‰å¯†åº¦
$$

#### æœ€å¤§ä¼¼ç„¶ä¼°è®¡

å³ä½¿å¾—ä¼¼ç„¶å‡½æ•°æžå¤§åŒ–çš„$\theta$å€¼ï¼Œç”±$\frac{dp(X^N|\theta)}{d\theta}=0$æ±‚å¾—ã€‚ä¸€èˆ¬ç”¨ä¼¼ç„¶å‡½æ•°çš„å¯¹æ•°è®¡ç®—ã€‚

è®¾$\omega_i$ç±»æ¨¡å¼çš„æ¦‚çŽ‡å¯†åº¦å‡½æ•°æœ‰pä¸ªæœªçŸ¥å‚æ•°ï¼Œè®°ä¸ºpç»´å‘é‡$\theta=[\theta_1,\theta_2,...,\theta_p]^T$ï¼Œæ­¤æ—¶
$$
lnp(X^N|\theta)=\sum^N_{k=1}lnp(X_k|\theta) \\
\frac{\part}{\part\theta}[\sum^N_{k=1}lnp(X_k|\theta)]=0ï¼Œå³\\
\left\{
\begin{aligned}
&\sum^N_{k=1}\frac{\part}{\part\theta_1}p(X_k|\theta)=0 \\
&\sum^N_{k=1}\frac{\part}{\part\theta_2}p(X_k|\theta)=0 \\
&... \\
&\sum^N_{k=1}\frac{\part}{\part\theta_p}p(X_k|\theta)=0
\end{aligned}
\right.
$$
è§£ä»¥ä¸Šå¾®åˆ†æ–¹ç¨‹å³å¯å¾—åˆ°$\theta$çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼ã€‚



### 4.5.2 è´å¶æ–¯ä¼°è®¡ä¸Žè´å¶æ–¯å­¦ä¹ 

- è´å¶æ–¯ä¼°è®¡å’Œå­¦ä¹ éƒ½æ˜¯å°†ä½ç½®å‚æ•°çœ‹ä½œéšæœºå‚æ•°è¿›è¡Œè€ƒè™‘



#### è´å¶æ–¯ä¼°è®¡

â€‹	é€šè¿‡ä¼¼ç„¶å‡½æ•°ï¼Œå¹¶åˆ©ç”¨è´å¶æ–¯å…¬å¼ï¼Œå°†éšæœºå˜é‡$\theta$çš„å…ˆéªŒæ¦‚çŽ‡å¯†åº¦$p(\theta)$è½¬å˜ä¸ºåŽéªŒæ¦‚çŽ‡å¯†åº¦$p(\theta|X^N)$ï¼Œç„¶åŽæ ¹æ®$\theta$çš„åŽéªŒæ¦‚çŽ‡å¯†åº¦æ±‚å‡ºä¼°è®¡é‡

- æ­¥éª¤

  1. ç¡®å®š$\theta$çš„å…ˆéªŒæ¦‚çŽ‡å¯†åº¦$p(\theta)$

  2. ç”±æ ·æœ¬é›†$X^N=\{X_1,X_2,...,X_N\}$æ±‚å‡º$p(X^N|\theta)$

  3. åˆ©ç”¨è´å¶æ–¯å…¬å¼æ±‚å‡ºåŽéªŒæ¦‚çŽ‡å¯†åº¦ï¼š
     $$
     p(\theta|X^N)=\frac{p(X^N|\theta)p(\theta)}{\int p(X^N|\theta)p(\theta)d\theta}
     $$

  4. æ±‚è´å¶æ–¯ä¼°è®¡é‡
     $$
     \widehat{\theta}=\int \theta p(\theta|X^N)d\theta
     $$



#### è´å¶æ–¯å­¦ä¹ 

â€‹	åˆ©ç”¨$\theta$çš„å…ˆéªŒæ¦‚çŽ‡å¯†åº¦åŠæ ·æœ¬æä¾›çš„ä¿¡æ¯æ±‚å‡º$\theta$çš„åŽéªŒæ¦‚çŽ‡å¯†åº¦ï¼Œæ ¹æ®åŽéªŒæ¦‚çŽ‡å¯†åº¦ç›´æŽ¥æ±‚å‡ºç±»æ¦‚çŽ‡å¯†åº¦å‡½æ•°$p(X|\omega_i)$

- è¿­ä»£å¼ï¼š
  $$
  p(\theta|X^N)=\frac{p(X_N|\theta)p(\theta|X^{N-1})}{\int p(X_N|\theta)p(\theta|X^{N-1})d\theta}
  $$



- æ­¥éª¤ï¼š

  1. æ ¹æ®å…ˆéªŒçŸ¥è¯†å¾—åˆ°$p(\theta)$çš„åˆå§‹ä¼°è®¡ï¼š$p(\theta)=p(\theta|X^0)$

  2. ç”¨$X_1$å¯¹åˆå§‹çš„$p(\theta)$è¿›è¡Œä¿®æ”¹ï¼š
     $$
     p(\theta|X^1)=p(\theta|X_1)=\frac{p(X_1|\theta)p(\theta)}{\int p(X_1|\theta)p(\theta)d\theta}
     $$

  3. ç»™å‡º$X_2$ï¼Œå¯¹ç”¨$X_1$ä¼°è®¡çš„ç»“æžœè¿›è¡Œä¿®æ”¹

  4. é€æ¬¡ç”¨æ ·æœ¬è¿›è¡Œè¿­ä»£ä¿®æ”¹

## 4.6 æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„éžå‚æ•°ä¼°è®¡æ–¹æ³•

### 4.6.1 åŸºæœ¬æ–¹æ³•

- å‡ºå‘ç‚¹ï¼š

  è‹¥è§‚å¯Ÿåˆ°ï¼šNä¸ªæ ·æœ¬ä¸­æœ‰kä¸ªè½å…¥åŒºåŸŸRä¸­ï¼Œåˆ™å¯ä»¥åˆç†è®¤ä¸ºï¼š

$$
\widehat{P}\approx k/N
$$

â€‹	è®¾$p(X)$è¿žç»­ï¼ŒåŒºåŸŸRè¶³å¤Ÿå°ï¼Œä¸”ä½“ç§¯ä¸ºVï¼Œ$p(X)$åœ¨Rä¸­æ²¡æœ‰å˜åŒ–ï¼ŒXæ˜¯Rä¸­çš„ç‚¹ï¼Œåˆ™Xç‚¹æ¦‚çŽ‡å¯†åº¦çš„ä¼°è®¡ï¼š
$$
\widehat{p}(X)\approx \frac{k/N}{V}
$$

- å­˜åœ¨çš„é—®é¢˜ï¼š

  - å›ºå®šV ï¼Œæ ·æœ¬æ•°å¢žå¤šï¼Œåˆ™k/Nä»¥æ¦‚çŽ‡1æ”¶æ•›ã€‚ä½†åªèƒ½å¾—åˆ°åœ¨æŸä¸€ä½“ç§¯Vä¸­çš„å¹³å‡ä¼°è®¡ã€‚
  - Nå›ºå®šï¼ŒVè¶‹äºŽé›¶ï¼Œp(X) = 0 æˆ–å‘æ•£åˆ°æ— ç©·å¤§ã€‚æ²¡æœ‰æ„ä¹‰ã€‚

- ä¼°è®¡çš„æ­¥éª¤ï¼š

  - æž„é€ ä¸€ä¸²åŒ…å«Xçš„åŒºåŸŸ$R_1,R_2,...,R_N,...$

  - å¯¹$R_1$é‡‡ç”¨ä¸€ä¸ªæ ·æœ¬ä¼°è®¡ï¼Œå¯¹$R_2$é‡‡ç”¨ä¸¤ä¸ªæ ·æœ¬ï¼Œ...

  - å‡å®š$V_N$æ˜¯$R_N$çš„ä½“ç§¯ï¼Œ$k_N$æ˜¯è½å…¥$R_N$å†…çš„æ ·æœ¬æ•°ç›®ï¼Œ$\widehat{p}_N(X)$æ˜¯$p(X)$çš„ç¬¬Næ¬¡ä¼°è®¡ï¼Œæœ‰
    $$
    \widehat{p}_N(X)=\frac{k_N/N}{V_N}
    $$

- ä¸ºä¿è¯ä¼°è®¡åˆç†æ€§ï¼Œåº”æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š
  $$
  1.\;\;lim_{N\rightarrow\infty}V_N=0 \\
  2.\;\; lim_{N\rightarrow\infty}k_N=\infty \\
  3. \;\; lim_{N\rightarrow\infty}k_N/N=0
  $$

- ä¸¤ç§éžå‚æ•°ä¼°è®¡æ³•ï¼š**Parzençª—æ³•ï¼Œ$k_N$è¿‘é‚»ä¼°è®¡æ³•**



### 4.6.2 Parzençª—æ³•

#### åŸºæœ¬æ¦‚å¿µ

$$
è®¾åŒºåŸŸR_N:dç»´è¶…ç«‹æ–¹ä½“ï¼Œæ£±é•¿ï¼šh_N,åˆ™ \\
V_N=h^d_N \\
å®šä¹‰çª—å‡½æ•°\varphi(\mu)=
\left\{
\begin{aligned}
&1,\quad å½“|\mu_j|\le \frac{1}{2};j=1,2,..,d \\
&0,\quad å…¶ä»–
\end{aligned}
\right. \\
å½“Xè½å…¥ä»¥X_iä¸ºä¸­å¿ƒï¼Œä½“ç§¯ä¸ºV_Nçš„è¶…ç«‹æ–¹ä½“æ—¶ï¼š\\
\phi_i(X)=\phi[(X-X_i)/h_N]=1 \\
å¦åˆ™ï¼Œ\phi_i(X)=0 \\
è½å…¥è¶…ç«‹æ–¹ä½“å†…çš„æ ·æœ¬æ•°ä¸º\\
k_N=\sum^N_{i=1}\varphi(\frac{X-X_i}{h_N}) \\
ä»£å…¥\widehat{p}_N(X)=\frac{k_N/N}{V_N}å¾— \\
\widehat{p}_N(X)=\frac{1}{N}\sum^N_{i=1}\frac{1}{V_N}\varphi(\frac{X-X_i}{h_N})\quad â€”â€”Parzençª—æ³•åŸºæœ¬å…¬å¼
$$

- **å®žè´¨**ï¼š

â€‹	çª—å‡½æ•°çš„ä½œç”¨æ˜¯å†…æ’ï¼ˆå¹³æ»‘ï¼‰ï¼Œæ ·æœ¬å¯¹ä¼°è®¡æ‰€èµ·çš„ä½œç”¨å–å†³äºŽå®ƒåˆ°Xçš„è·ç¦»

- $\varphi(\mu)$åº”æ»¡è¶³çš„ä¸¤ä¸ªæ¡ä»¶ï¼š
  1. $\varphi(u)\ge 0$
  2. $\int\varphi(u)du=1$

#### çª—å‡½æ•°çš„é€‰æ‹©

![1](../../../../../%E5%A4%A7%E4%B8%89%E4%B8%8A/%E4%B8%93%E4%B8%9A%E8%AF%BE/Notes/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB/Notes/images/1.PNG)

- çª—å®½$h_N$å¯¹ä¼°è®¡é‡$\widehat{p}_N(X)$çš„å½±å“å¾ˆå¤§



# 5. ç‰¹å¾æå–ä¸Žé€‰æ‹©

## 5.2 ç±»åˆ«å¯åˆ†æ€§æµ‹åº¦

- ç±»åˆ«å¯åˆ†æ€§æµ‹åº¦ï¼šè¡¡é‡ç±»åˆ«é—´å¯åˆ†æ€§çš„å°ºåº¦
  - å‡ ä½•åˆ†å¸ƒï¼šç±»å†…è·ç¦»å’Œç±»é—´è·ç¦»
  - æ¦‚çŽ‡åˆ†å¸ƒï¼šç±»æ¦‚çŽ‡å¯†åº¦å‡½æ•°
  - è¯¯åˆ¤æ¦‚çŽ‡ï¼šä¸Žé”™è¯¯çŽ‡æœ‰å…³çš„è·ç¦»

### 5.2.1 åŸºäºŽè·ç¦»çš„å¯åˆ†æ€§æµ‹åº¦

#### 1. ç±»å†…æ•£å¸ƒè·ç¦»å’Œç±»å†…æ•£å¸ƒçŸ©é˜µ

1. $\omega_i$ç±»çš„ç±»å†…è·ç¦»ä¸€ï¼šç±»å†…ï¼ˆæ ·æœ¬é—´ï¼‰å‡æ–¹ä¸¤ä¸¤è·ç¦»
   $$
   \overline{D_i^2}=E[||X_k-X_l||^2|\omega_i]=E[(X_k-X_l)^T(X_k-X_l)|\omega_i] \\
   å…¶ä¸­X_kå’ŒX_lï¼šå‡ä¸ºåŒä¸€ç±»æ¨¡å¼æ ·æœ¬
   $$
   è‹¥{$X_i$}ä¸­æ ·æœ¬ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ï¼š
   $$
   \overline{D_i^2}=2Tr[C_i]=2\sum^n_{k=1}\sigma^2_k
   $$

2. $\omega_i$ç±»çš„ç±»å†…è·ç¦»äºŒï¼šç±»å†…ï¼ˆæ ·æœ¬é—´ï¼‰å‡æ–¹æ•£å¸ƒè·ç¦»
   $$
   \overline{D_{w,i}^2}=E[||X_k-M_i||^2\ |\ X_k\in \omega_i] \\
   M_i:ç¬¬iç±»çš„å‡å€¼å‘é‡
   $$

3. ä¸¤ä¸ªç±»å†…è·ç¦»çš„è®¡ç®—å¼
   $$
   \overline{D_{w,\ i}^2}=E[||X_k-M_i||^2\ |\ \omega_i]=\frac{1}{n}\sum^{n_i}_{k=1}(X_k^i-M_i)^T(X_k^i-M_i) \\
   \overline{D^2_w}=\sum^c_{i=1}P(\omega_i)D_{w,i}^2=\sum^c_{i=1}P(\omega_i)[\frac{1}{n}\sum^{n_i}_{k=1}(X^i_k-M_i)^T(X^i_k-M_i)] \\
   \overline{D^2_i}=E[{(X_k-X_l)^T(X_k-X_l)|\omega_i}]=\frac{1}{n_i(n_i-1)}\sum^{n_i}_{k=1}\sum^{n_i}_{l=1,l\ne k}(X^i_k-X^i_l)^T(X_k^i-X_l^i)
   $$





4. ç±»å†…æ•£å¸ƒçŸ©é˜µï¼šè¡¨ç¤ºå„æ ·æœ¬ç‚¹å›´ç»•ç±»å‡å€¼çš„æ•£å¸ƒæƒ…å†µâ€”â€”å³ç¬¬iç±»åˆ†å¸ƒçš„**åæ–¹å·®çŸ©é˜µ**ï¼š
   $$
   S_{w,i}=E[(X-M_i)(X-M_i)^T|\omega_i]=\frac{1}{n}\sum^{n_i}_{k=1}(X_k^i-M_i)(X_k^i-M_i)^T \\
   å¯çŸ¥ï¼Œ\overline{D^2_{w,i}}=Tr(S_{w,i}) \\
   è®¡ç®—ï¼š \\
   C=\frac{1}{n}\sum^n_{i=1}X_iX^T_i-MM^T
   $$
   **ç‰¹å¾é€‰æ‹©å’Œæå–çš„ç»“æžœåº”ä½¿ç±»å†…æ•£å¸ƒçŸ©é˜µçš„è¿¹è¶Šå°è¶Šå¥½**

#### 2. ç±»é—´æ•£å¸ƒè·ç¦»å’Œç±»é—´æ•£å¸ƒçŸ©é˜µ

1. ç±»é—´è·ç¦»ä¸€ï¼šå„æ¨¡å¼ç±»å‡å€¼å‘é‡ä¹‹é—´**è·ç¦»å¹³æ–¹çš„åŠ æƒå’Œ**ï¼š
   $$
   \overline{D^2}=\frac{1}{2}\sum^c_{i=1}P(\omega_i)\sum^c_{j=1}P(\omega_j)||M_i-M_j||^2
   $$



2. ç±»é—´è·ç¦»äºŒï¼šå„æ¨¡å¼ç±»å‡å€¼å‘é‡ä¸Žæ€»ä½“å‡å€¼å‘é‡ä¹‹é—´è·ç¦»å¹³æ–¹çš„åŠ æƒå’Œâ€”â€”**ç±»é—´å‡æ–¹æ•£å¸ƒè·ç¦»**ï¼š
   $$
   \overline{D_b^2}=\sum^c_{i=1}P(\omega_i)(M_i-M_0)^T(M_i-M_0) \\
   å…¶ä¸­ï¼ŒM_0:æ‰€æœ‰cç±»æ¨¡å¼çš„æ€»ä½“å‡å€¼å‘é‡
   $$

3. ç±»é—´æ•£å¸ƒçŸ©é˜µï¼šè¡¨ç¤ºcç±»æ¨¡å¼åœ¨ç©ºé—´çš„æ•£å¸ƒæƒ…å†µï¼š
   $$
   S_b=\sum^c_{i=1}P(\omega_i)(M_i-M_0)(M_i-M_0)^T
   $$

4. ç±»é—´æ•£å¸ƒè·ç¦»å’Œç±»é—´æ•£æ­¥çŸ©é˜µçš„å…³ç³»ï¼š
   $$
   \overline{D_b^2}=Tr(S_b)
   $$
   **ç±»é—´æ•£å¸ƒçŸ©é˜µçš„è¿¹è¶Šå¤§è¶Šæœ‰åˆ©äºŽåˆ†ç±»ã€‚**

#### 3. å¤šç±»æ¨¡å¼å‘é‡é—´çš„æ€»ä½“è·ç¦»å’Œæ€»ä½“æ•£å¸ƒçŸ©é˜µ

##### ä¸¤ç±»æƒ…å†µçš„è·ç¦»

$$
è®¾\omega_1ç±»æœ‰qä¸ªæ ·æœ¬ï¼Œ\omega_2ç±»ä¸­æœ‰pä¸ªæ ·æœ¬ï¼Œåˆ™ \\
ä¸¤ä¸ªç±»ä¹‹é—´çš„è·ç¦»=p\times qä¸ªç‚¹é—´è·ç¦»çš„å¹³å‡å€¼
$$

##### å¤šç±»æƒ…å†µçš„æ€»ä½“è·ç¦»

1. å¤šç±»æ¨¡å¼å‘é‡é—´çš„æ€»ä½“å‡æ–¹è·ç¦»ï¼š
   $$
   J_d=\frac{1}{2}\sum^c_{i=1}P(\omega_i)\sum^c_{j=1}P(\omega_j)\frac{1}{n_in_j}\sum^{n_i}_{k=1}\sum^{n_j}_{l=1}D^2(X_k^i,X_l^j) \\
   å…¶ä¸­ï¼Œn_iå’Œn_jï¼š\omega_iå’Œ\omega_jç±»çš„æ ·æœ¬æ•°ï¼› \\
   D^2(X^i_k,X_l^j):X_k^iå’ŒX_l^jé—´æ¬§æ°è·ç¦»çš„å¹³æ–¹
   $$

2. æ€»ä½“å‡æ–¹è·ç¦»çš„å¦ä¸€ç§å½¢å¼ï¼š
   $$
   J_d=\sum^c_{i=1}P(\omega_i)[\frac{1}{n}\sum^{n_i}_{k=1}(X_k^i-M_i)^T(X_k^i-M_i)]+\sum^c_{i=1}P(\omega_i)[(M_i-M_0)^T(M_i-M_0)] \\
   =\overline{D_w^2}+\overline{D_b^2} \\
   å³ï¼š å¤šç±»æ¨¡å¼å‘é‡ä¹‹é—´çš„æ€»ä½“å‡æ–¹è·ç¦»=
   \left\{
   \begin{aligned}
   æ¨¡å¼ç±»å†…æ•£&å¸ƒè·ç¦»åŠ æƒå’Œ \\
   & + \\
   æ¨¡å¼ç±»é—´æ•£&å¸ƒè·ç¦»åŠ æƒå’Œ
   \end{aligned}
   \right.
   $$



3. å¤šç±»æƒ…å†µçš„æ•£å¸ƒçŸ©é˜µï¼š

   - å¤šç±»ç±»é—´æ•£å¸ƒçŸ©é˜µï¼š

   $$
   S_b=\sum^c_{i=1}P(\omega_i)(M_i-M_0)(M_i-M_0)^T
   $$

   - $\omega_i$ç±»å†…æ•£å¸ƒçŸ©é˜µï¼š
     $$
     S_{w,i}=E[(X-M_i)(X-M_i)^T|\omega_i]=\frac{1}{n}\sum^{n_i}_{k=1}(X_k^i-M_i)^T
     $$

   - å¤šç±»ç±»å†…æ•£å¸ƒçŸ©é˜µï¼š
     $$
     S_w=\sum^c_{i=1}P(\omega_i)\frac{1}{n}\sum^{n_i}_{k=1}(X_k^i-M_i)(X_k^i-M_i)^T
     $$

   - å¤šç±»æ€»ä½“æ•£å¸ƒçŸ©é˜µï¼š
     $$
     S_t=E[(X-M_0)(X-M_0)^T]=S_b+S_w
     $$

4. å¤šç±»æ¨¡å¼çš„æ€»ä½“å‡æ–¹è·ç¦»$J_d$ä¸Žæ€»ä½“æ•£å¸ƒçŸ©é˜µ$S_t$çš„å…³ç³»ï¼š
   $$
   J_d=tr(S_t)=tr(S_b+S_w)
   $$



### 5.2.2 åŸºäºŽæ¦‚çŽ‡åˆ†å¸ƒçš„å¯åˆ†æ€§æµ‹åº¦

#### 1. æ•£åº¦

##### (1) æ•£åº¦å®šä¹‰

å¹³å‡å¯åˆ†æ€§ä¿¡æ¯â€”â€”å¯¹æ•°ä¼¼ç„¶æ¯”çš„æœŸæœ›å€¼ã€‚

æ•£åº¦ = ä¸¤ç±»é—´å¯¹æ•°ä¼¼ç„¶æ¯”æœŸæœ›å€¼ä¹‹å’Œ
$$
\omega_iç±»å¯¹\omega_jç±»çš„æ•£åº¦å®šä¹‰ä¸ºJ_{ij}: \\
J_{ij}=I_{ij}+I_{ji}=\int_X[p(X|\omega_i)-p(X|\omega_j)]ln\frac{p(X|\omega_i)}{p(X|\omega_j)}dX
$$
æ•£åº¦è¡¨ç¤ºäº†åŒºåˆ†$\omega_i$ç±»å’Œ$\omega_j$ç±»çš„æ€»çš„å¹³å‡ä¿¡æ¯ã€‚

**â€”â€”ç‰¹å¾é€‰æ‹©å’Œç‰¹å¾æå–åº”ä½¿æ•£åº¦å°½å¯èƒ½çš„å¤§ã€‚**

##### (2) æ•£åº¦æ€§è´¨

1. $J_{ij}=J_{ji}$

2. $J_{ij}$ä¸ºéžè´Ÿï¼Œå³$J_{ij}\ge 0$

   - å½“$p(X|\omega_i)\ne p(X|\omega_j)$æ—¶ï¼Œ$J_{ij} \gt 0$
   - $J_{ij}$è¶Šå¤§ï¼Œ$p(X|\omega_i)$ä¸Ž$p(X|\omega_j)$ç›¸å·®è¶Šå¤§
   - å½“$p(X|\omega_i) = p(X|\omega_j)$æ—¶ï¼Œä¸¤ç±»åˆ†å¸ƒå¯†åº¦ç›¸åŒï¼Œ$J_{ij}=0$ã€‚

3. é”™è¯¯çŽ‡åˆ†æžä¸­ï¼Œæ•£åº¦æ„ˆå¤§ï¼Œä¸¤ç±»æ¦‚çŽ‡å¯†åº¦æ›²çº¿ç›¸å·®è¶Šå¤§ï¼Œäº¤å è¶Šå°‘ï¼Œé”™è¯¯çŽ‡è¶Šå°ã€‚

4. æ•£åº¦å…·æœ‰ç‹¬ç«‹å¯åŠ æ€§ï¼Œå³å½“å„åˆ†é‡ç›¸äº’ç‹¬ç«‹æ—¶ï¼Œæœ‰ï¼š
   $$
   J_{ij}(X)=J_{ij}(x_1,x_2,...,x_n)=\sum^n_{k=1}J_{ij}(x_k)
   $$

5. åŠ å…¥ç‹¬ç«‹çš„æ–°ç‰¹æ€§ä¸ä¼šä½¿æ•£åº¦å‡å°ã€‚å³$J_{ij}(x_1,x_2,...,x_n)\le J_{ij}(x_1,x_2,...,x_n,x_{n+1})$ã€‚

##### (3) ä¸¤ä¸ªç­‰æ–¹å·®æ­£æ€åˆ†å¸ƒæ¨¡å¼ç±»çš„æ•£åº¦

$$
\omega_iç±»å’Œ\omega_jç±»çš„æ¦‚çŽ‡å¯†åº¦å‡½æ•°ä¸ºï¼š\\
p(X|\omega_i)\sim N(M_i,C) \\
p(X|\omega_i)\sim N(M_i,C) \\
åˆ™ï¼Œ\omega_iç±»å¯¹\omega_jç±»çš„æ•£åº¦ä¸º \\
J_{ij}=(M_i-M_j)^TC^{-1}(M_i-M_j) \quad â€”â€”ä¸¤æ¨¡å¼ç±»å‡å€¼å‘é‡é—´çš„é©¬æ°è·ç¦»çš„å¹³æ–¹\\
ä¸€ç»´æ­£æ€åˆ†å¸ƒæ—¶ï¼šJ_{ij}=\frac{(m_i-m_j)^2}{\sigma^2}
$$

## 5.3 åŸºäºŽç±»å†…æ•£å¸ƒçŸ©é˜µçš„å•ç±»æ¨¡å¼ç‰¹å¾æå–

- ç‰¹å¾æå–çš„ç›®çš„ï¼š

  - å¯¹æŸç±»æ¨¡å¼ï¼šåŽ‹ç¼©æ¨¡å¼å‘é‡çš„ç»´æ•°
  - å¯¹å¤šç±»åˆ†ç±»ï¼šåŽ‹ç¼©æ¨¡å¼å‘é‡çš„ç»´æ•°ï¼›ä¿ç•™ç±»åˆ«é—´çš„é‰´åˆ«ä¿¡æ¯ï¼Œçªå‡ºå¯åˆ†æ€§

- ç‰¹å¾æå–æ–¹æ³•ï¼š

  - æ³¨æ„:ç»´æ•°é™ä½ŽåŽï¼Œåœ¨æ–°çš„mç»´ç©ºé—´é‡Œå„æ¨¡å¼ç±»ä¹‹é—´çš„åˆ†å¸ƒè§„å¾‹åº”è‡³å°‘ä¿æŒä¸å˜æˆ–æ›´ä¼˜åŒ–ã€‚

  $$
  è‹¥\{X\in \omega_i\}æ˜¯\omega_iç±»çš„ä¸€ä¸ªnç»´æ ·æœ¬é›†ï¼Œå°†XåŽ‹ç¼©æˆmç»´çš„å‘é‡X^*\quad (m \lt n)\\
  â€”â€”å¯»æ‰¾ä¸€ä¸ªm\times nçŸ©é˜µAï¼Œåšå˜æ¢ï¼š\\
  X^*=AX \\
  X^*:m \times 1, \; A:m \times n, \; X:n \times 1
  $$


### ç¡®å®šå˜æ¢çŸ©é˜µ

- æ ¹æ®ç±»å†…æ•£å¸ƒçŸ©é˜µç¡®å®šå˜æ¢çŸ©é˜µAï¼š

$$
è®¾\omega_iç±»æ¨¡å¼çš„å‡å€¼å‘é‡ä¸ºMï¼Œç±»å†…æ•£å¸ƒçŸ©é˜µï¼ˆåæ–¹å·®çŸ©é˜µï¼‰ä¸ºCï¼š\\
M=E\{X\} \\
C=E\{(X-M)(X-M)^T\} \\
è®¾çŸ©é˜µCçš„nä¸ªç‰¹å¾å€¼åˆ†åˆ«ä¸º\lambda_1,\lambda_2,...,\lambda_nï¼Œä»»ä¸€ç‰¹å¾å€¼æ˜¯æ»¡è¶³ |\lambda I-C|=0çš„ä¸€ä¸ªè§£ã€‚\\
å…¶åˆ†åˆ«å¯¹åº”çš„ç‰¹å¾å‘é‡ä¸ºu_k,åˆ™u_kæ˜¯æ»¡è¶³ \\
Cu_k=\lambda_ku_k \ \ çš„ä¸€ä¸ªéžé›¶è§£ \\
é€‰æ‹©nä¸ªå½’ä¸€åŒ–ç‰¹å¾å‘é‡ä½œä¸ºAçš„è¡Œï¼Œåˆ™Aä¸ºå½’ä¸€åŒ–æ­£äº¤çŸ©é˜µï¼š\\
A=
\begin{bmatrix}
u_1^T \\
u_2^T \\
... \\
u_n^T
\end{bmatrix}
\quad\quad 
A^T=[u_1\ u_2 \ ...\ u_n]
\quad\quad
AA^T=I
$$

â€‹	å˜æ¢åŽ: åæ–¹å·®çŸ©é˜µä¸ºå¯¹è§’é˜µï¼Œè¯´æ˜ŽX*çš„å„åˆ†é‡ä¸ç›¸å…³çš„ï¼ â€”â€”ä¾¿äºŽç‰¹å¾çš„å–èˆï¼›

â€‹	**$X^*$çš„ç¬¬kä¸ªåˆ†é‡çš„æ–¹å·®ç­‰äºŽæœªå˜æ¢æ—¶Cçš„ç‰¹å¾å€¼$\lambda_k$**ã€‚

â€‹	å˜æ¢åŽçš„ç±»å†…è·ç¦»ä¿æŒä¸å˜ ã€‚

- ç‰¹å¾æå–çš„æ–¹æ³•

  æ­¥éª¤ï¼š

  - æ ¹æ®æ ·æœ¬é›†æ±‚$\omega_i$ç±»çš„åæ–¹å·®çŸ©é˜µï¼ˆç±»å†…æ•£å¸ƒçŸ©é˜µï¼‰
    $$
    C=\frac{1}{N}\sum^N_{i=1}(X_i-M)(X_i-M)^T=\frac{1}{N}\sum^N_{i=1}X_iX_i^T-MM^T
    $$

  - è®¡ç®—Cçš„ç‰¹å¾å€¼ï¼Œå¯¹**ç‰¹å¾å€¼ä»Žå°åˆ°å¤§è¿›è¡ŒæŽ’é˜Ÿ**ï¼Œé€‰æ‹©å‰mä¸ªã€‚

  - è®¡ç®—å‰mä¸ªç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œå¹¶å½’ä¸€åŒ–å¤„ç†ã€‚å°†å½’ä¸€åŒ–åŽçš„ç‰¹å¾å‘é‡çš„è½¬ç½®ä½œä¸ºçŸ©é˜µAçš„è¡Œï¼š
    $$
    A=
    \begin{bmatrix}
    u_1^T \\
    u_2^T \\
    ...\\
    u^T_m
    \end{bmatrix}
    $$

  - åˆ©ç”¨Aå¯¹æ ·æœ¬é›†{X}è¿›è¡Œå˜æ¢ï¼š
    $$
    X^*=AX
    $$

    - mç»´(m < n)æ¨¡å¼å‘é‡X*å°±æ˜¯ä½œä¸ºåˆ†ç±»ç”¨çš„æ¨¡å¼å‘é‡ã€‚

## 5.4 åŸºäºŽK-Lå˜æ¢çš„å¤šç±»æ¨¡å¼ç‰¹å¾æå–

**å¡æ´›å—-æ´›ä¼Šå˜æ¢ï¼ˆK-Lå˜æ¢ï¼‰**ï¼š

- æœ€å°å‡æ–¹è¯¯å·®é€¼è¿‘æ„ä¹‰ä¸‹çš„æœ€ä¼˜æ­£äº¤å˜æ¢
- é€‚ç”¨äºŽä»»æ„çš„æ¦‚çŽ‡å¯†åº¦å‡½æ•°
- åœ¨æ¶ˆé™¤æ¨¡å¼ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ã€çªå‡ºå·®å¼‚æ€§æ–¹é¢æœ‰æœ€ä¼˜çš„æ•ˆæžœ
- åˆ†ä¸ºï¼šè¿žç»­K-Lå˜æ¢ã€ç¦»æ•£K-Lå˜æ¢

### 5.4.1 K-Lå±•å¼€å¼

è®¾{X}æ˜¯ n ç»´éšæœºæ¨¡å¼å‘é‡ X çš„é›†åˆï¼Œå¯¹æ¯ä¸€ä¸ªXå¯ä»¥ç”¨ç¡®å®šçš„å®Œå¤‡å½’ä¸€åŒ–æ­£äº¤å‘é‡ç³»$\{\textbf{u}_j\}$ä¸­çš„æ­£äº¤å‘é‡**å±•å¼€å¼**ï¼š
$$
X=\sum^{\infty}_{j=1}a_j\textbf{u}_j  \quad\quad a_j:éšæœºç³»æ•°;\\
ç”¨æœ‰é™é¡¹ä¼°è®¡Xæ—¶ï¼š\widehat{X}= \sum^{d}_{j=1}a_j\textbf{u}_j
$$
é€‰å‰dé¡¹ä¼°è®¡Xæ—¶å¼•èµ·çš„å‡æ–¹è¯¯å·®ä¸ºï¼š
$$
\xi =\sum^n_{j=d+1}u^T_jRu_j=\sum^n_{j=d+1}Tr[u_jRu_j^T]=\sum^{\infty}_{j=d+1}\lambda_j
$$
â€‹	$Î»_j$ å†³å®šæˆªæ–­çš„å‡æ–¹è¯¯å·®ï¼Œ$Î»_j$ çš„å€¼å°ï¼Œé‚£ä¹ˆ Î¾ ä¹Ÿå°ï¼Œå³ **ä½¿ç¬¬(d+1)é¡¹åŠå…¶ä¹‹åŽçš„é¡¹æœ€å°**ã€‚å› æ­¤ï¼Œå½“ç”¨Xçš„æ­£äº¤å±•å¼€å¼ä¸­çš„å‰dé¡¹ä¼°è®¡Xæ—¶ï¼Œå±•å¼€å¼ä¸­çš„$u_j$åº”å½“æ˜¯**å‰dä¸ªè¾ƒå¤§çš„ç‰¹å¾å€¼**å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚ 

è¯´æ˜Ž:å½“ç”¨Xçš„è‡ªç›¸å…³çŸ©é˜µRçš„ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡å±•å¼€Xæ—¶ï¼Œæˆªæ–­è¯¯å·®æœ€å°ã€‚

**K-Lå˜æ¢å…·ä½“æ–¹æ³•**ï¼š

- å¯¹Rçš„ç‰¹å¾å€¼ç”±å¤§åˆ°å°è¿›è¡ŒæŽ’é˜Ÿ

- å‡æ–¹è¯¯å·®æœ€å°çš„Xçš„è¿‘ä¼¼å¼ï¼š$X=\sum^d_{j=1}a_j\textbf{u}_j$ï¼ˆ**K-Lå±•å¼€**ï¼‰

- çŸ©é˜µå½¢å¼ï¼š$X=Ua$

  å…¶ä¸­ï¼š$a=[a_1,a_2,...,a_d]^T,\quad U_{n\times d}=[u_1,...,u_j,...,u_d],\quad u_j=[u_{j1},u_{j2},...,u_{jn}]^T$

  å¯¹å¼ä¸¤è¾¹å·¦ä¹˜$U^t:\  a=U^TX$ï¼ˆ**K-Lå˜æ¢**ï¼‰

  å‘é‡aå°±æ˜¯å˜æ¢åŽçš„æ¨¡å¼å‘é‡ã€‚

### 5.4.2 åˆ©ç”¨è‡ªç›¸å…³çŸ©é˜µçš„K-Lå˜æ¢è¿›è¡Œç‰¹å¾æå–

è®¾ X æ˜¯ n ç»´æ¨¡å¼å‘é‡ï¼Œ{X}æ˜¯æ¥è‡ª M ä¸ªæ¨¡å¼ç±»çš„æ ·æœ¬é›†ï¼Œæ€»æ ·æœ¬æ•°ç›®ä¸º Nã€‚ 

å°†Xå˜æ¢ä¸ºdç»´å‘é‡çš„æ–¹æ³•ï¼š

1. æ±‚æ ·æœ¬é›†{X}çš„æ€»ä½“è‡ªç›¸å…³çŸ©é˜µRï¼š
   $$
   R=E[XX^T]\approx \frac{1}{N}\sum^N_{j=1}X_jX^T_j
   $$

2. æ±‚Rçš„ç‰¹å¾å€¼$\lambda_jï¼Œj=1,2,...,n$ï¼Œå¯¹ç‰¹å¾å€¼**ç”±å¤§åˆ°å°**è¿›è¡ŒæŽ’é˜Ÿï¼Œé€‰æ‹©å‰dä¸ªè¾ƒå¤§çš„ç‰¹å¾å€¼ã€‚

3. è®¡ç®—dä¸ªç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡$\textbf{u}_j$ï¼Œå½’ä¸€åŒ–åŽæž„æˆå˜æ¢çŸ©é˜µU
   $$
   U=[u_1,u_2,...,u_d]
   $$

4. å¯¹{X}ä¸­çš„æ¯ä¸ªXè¿›è¡ŒK-Lå˜æ¢ï¼Œå¾—å˜æ¢åŽå‘é‡$X^*$ï¼š
   $$
   X^*=U^TX
   $$





### 5.4.3 ä½¿ç”¨ä¸åŒæ•£å¸ƒçŸ©é˜µè¿›è¡ŒK-Lå˜æ¢

#### é‡‡ç”¨å¤šç±»ç±»å†…æ•£æ­¥çŸ©é˜µ$S_w$ä½œK-Lå˜æ¢

å¤šç±»ç±»å†…æ•£å¸ƒçŸ©é˜µï¼š
$$
S_w=\sum^c_{i=1}P(\omega_i)E[(X-M_i)(X-M_i)^T|X\in\omega_i]
$$

- è‹¥è¦çªå‡ºå„ç±»æ¨¡å¼çš„**ä¸»è¦ç‰¹å¾åˆ†é‡çš„åˆ†ç±»ä½œç”¨**ï¼šé€‰ç”¨å¯¹åº”äºŽ**å¤§ç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡**ç»„æˆå˜æ¢çŸ©é˜µ
- è‹¥è¦**ä½¿åŒä¸€ç±»æ¨¡å¼èšé›†äºŽæœ€å°çš„ç‰¹å¾ç©ºé—´èŒƒå›´**ï¼šé€‰ç”¨å¯¹åº”äºŽ**å°ç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡**ç»„æˆå˜æ¢çŸ©é˜µ

#### é‡‡ç”¨ç±»é—´æ•£å¸ƒçŸ©é˜µ$S_b$ä½œK-Lå˜æ¢

ç±»é—´æ•£å¸ƒçŸ©é˜µï¼š
$$
S_b=\sum^c_{i=1}P(\omega_i)(M_i-M_0)(M_i-M_0)^T
$$
é€‚ç”¨äºŽ**ç±»é—´è·ç¦»æ¯”ç±»å†…è·ç¦»å¤§å¾—å¤šçš„å¤šç±»é—®é¢˜**ï¼Œé€‰æ‹©ä¸Ž**å¤§ç‰¹å¾å€¼**å¯¹åº”çš„ç‰¹å¾å‘é‡ç»„æˆå˜æ¢çŸ©é˜µã€‚

#### é‡‡ç”¨æ€»ä½“æ•£å¸ƒçŸ©é˜µ$S_t$ä½œK-Lå˜æ¢

- æŠŠå¤šç±»æ¨¡å¼åˆå¹¶èµ·æ¥çœ‹æˆä¸€ä¸ªæ€»ä½“åˆ†å¸ƒã€‚
- æ€»ä½“æ•£å¸ƒçŸ©é˜µï¼š$S_t=E[(X-M_0)(X-M_0)^T]=S_b+S_w$
- é€‚åˆäºŽ**å¤šç±»æ¨¡å¼åœ¨æ€»ä½“åˆ†å¸ƒä¸Šå…·æœ‰è‰¯å¥½çš„å¯åˆ†æ€§çš„æƒ…å†µ**ã€‚
- é‡‡ç”¨**å¤§ç‰¹å¾å€¼**å¯¹åº”çš„ç‰¹å¾å‘é‡ç»„æˆå˜æ¢çŸ©é˜µï¼Œèƒ½å¤Ÿä¿ç•™æ¨¡å¼åŽŸæœ‰åˆ†å¸ƒçš„ä¸»è¦ç»“æž„ã€‚

## 5.5 ç‰¹å¾é€‰æ‹©

### 5.5.1 ç‰¹å¾é€‰å–çš„å‡†åˆ™

#### 1. æ•£å¸ƒçŸ©é˜µå‡†åˆ™

![2](images/5-5-1.PNG)

#### 2. æ•£åº¦å‡†åˆ™

ç”¨äºŽæ­£æ€åˆ†å¸ƒçš„æ¨¡å¼ç±»ã€‚

- ä¸¤ç±»çš„æ•£åº¦è¡¨è¾¾å¼ï¼š
  $$
  J_{ij}=\frac{1}{2}Tr[(C_j^{-1}-C_i^{-1})(C_i-C_j)]+\frac{1}{2}Tr[(C_i^{-1}+C_j^{-1})(M_i-M_j)(M_i-M_j)^T]
  $$

- å¹³å‡æ•£åº¦ï¼š
  $$
  J=\sum^{c-1}_{i=1}\sum^c_{j=i+1}p(\omega_i)p(\omega_j)J_{ij} \quad é€‰æ‹©ä½¿Jæœ€å¤§çš„ç‰¹å¾å­é›†
  $$

- å˜æ¢æ•£åº¦
  $$
  J_{ij}^T=100\%\times[1-exp(-J_{ij}/8)]
  $$

- å¹³å‡å˜æ¢æ•£åº¦
  $$
  J^T=\sum^{c-1}_{i=1}\sum^c_{j=i+1}p(\omega_i)p(\omega_j)J_{ij}^T
  $$




### 5.5.2 ç‰¹å¾é€‰æ‹©çš„æ–¹æ³•

- ä»Žnä¸ªç‰¹å¾ä¸­æŒ‘é€‰dä¸ªç‰¹å¾ï¼Œæ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å­é›†æ•°ä¸º $C^d_n = \frac{n!}{(n-d)!d!}$

- ç©·ä¸¾æ³•ï¼šè®¡ç®—å‡ºå„ç§å¯èƒ½ç‰¹å¾ç»„åˆçš„æŸä¸ªæµ‹åº¦å€¼ï¼ŒåŠ ä»¥æ¯”è¾ƒï¼Œé€‰æ‹©æœ€ä¼˜ç‰¹å¾ç»„ã€‚ 
  - ç‰¹ç‚¹ï¼šå¯ä»¥å¾—åˆ°æœ€ä¼˜ç‰¹å¾ç»„; è®¡ç®—é‡å¤§ï¼Œéš¾å®žçŽ°ã€‚é‡‡å–æœç´¢æŠ€æœ¯å¯é™ä½Žè®¡ç®—é‡ã€‚ 

1. æœ€ä¼˜æœç´¢ç®—æ³•
2. æ¬¡ä¼˜æœç´¢ç®—æ³•