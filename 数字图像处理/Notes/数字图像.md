# 数字图像处理复习

> 转载修改自：软软的笔记+ppt
>
> 题型：选择题、判断题、简答题、计算分析题
>
> 需要看和思考的地方：
>
> 1. **2.5.2邻近性**
> 2. **2.6.3 降噪例子**
> 3. **3.3.1 直方图均衡** 例子
> 4. **3.7 锐化空间滤波**
> 5. 哈夫曼编码做题
> 6. 算术编码复习、做题
> 7. jpeg编码重点！！！
> 8. 第9章

# 1 绪论

- 数字图像
  - 像素坐标和灰度值都是离散值的图像称为数字图像。
    - f(x,y)——幅值f：该点的强度或者灰度；
    - (x,y)：空间坐标；
    - 当(x,y)和f为有限、离散的数值时，该图像为数字图像。
- 数字图像处理
  - 借助于数字计算机来处理数字图像
- 数字图像的来源
  - 数字图像几乎覆盖了整个电磁波谱范围，并不仅限于可见光波段（主要是电磁波谱，此外还有声波、超声波和电子及计算机产生）。



# 2 数字图像基础

## 2.1 视觉感知要素

- 人眼的结构——光感受器
  - 视网膜表面的光接收器为锥状体和杆状体．
    - **锥状体**：**对颜色灵敏**，位于中央凹，细节感知，**能分辨图像细节**，锥状体视觉被称为白昼视觉或亮视觉。
    - **杆状体**：给出视野**总体图像**，**无彩色感觉，对低照明度敏感**，杆状视觉称为暗视觉或微光视觉。

## 2.2 光和电磁谱

- 光是一种特殊的电磁辐射，可以被人眼感知。可见光波长范围为0.43μm-0.79μm。
- 人感受到的物体颜色由物体反射的光的波长决定

## 2.4 图像取样与量化

### 2.4.2 数字图像表示

**数字图像**：是指由被称作像素的小块区域组成的二维矩阵。将物理图像行列划分后，每个小块区域称为**像素**（pixel）。

每个(x, y)对于数字图像中的一个基本单元，称其为图像元素(picture element)，简称为像素。看上去一个“像素”就是一个正方形的色块，事实上，“像素”是一个纯理论的概念，它没有形状也没有尺寸，看不见摸不着，只存在于理论计算中。

- 每个像素有两个属性：位置和亮度（或色彩）
- 对灰度图像而言，每个像素的亮度用一个数值（即灰度值）来表示，通常数值范围在0到255之间，即可用一个字节来表示，0表示黑、255表示白，而其它表示灰度级别。
- 彩色图像可以用红、绿、蓝三元组的二维矩阵来表示。

### 2.4.3 空间和灰度分辨率

指该图像在空间域上的采样数。指单位图像线性尺寸中所包含的像素数目，通常以像素/英寸 (ppi)为计量单位。

## 2.5 像素间的基本关系

### 2.5.1 相邻像素

- 像素邻域：每个像素由近邻像素组成的领域。

- 位于坐标(x,y)处的像素p有4个水平和垂直的相邻像素，其坐标为：
  $$
  (x+1,y),(x-1,y),(x,y+1),(x,y-1)
  $$
  这组像素称为p的**4邻域**，用$N_4(p)$表示。

- p的4个**对角相邻像素**的坐标如下：
  $$
  (x+1,y+1),(x+1,y-1),(x-1,y+1),(x-1,y-1)
  $$
  并用$N_D(p)$表示

- 4邻域像素和4个对角相邻像素一起称为**8邻域**，用$N_8(p)$表示。

### 2.5.2 邻接性、连通性、区域和边界

- 令V是用于定义邻接性的灰度值集合。在二值图像中，把具有1值的像素归入V，在灰度图像中，V包含更多的元素。

  考虑三种类别的邻接：

  1. 4邻接：如果q在集合$N_4(p)$中，则具有V中数值的两个像素p和q是4邻接的。
  2. 8邻接：如果q在集合$N_8(p)$中，则具有V中数值的两个像素p和q是8邻接的。
  3. m邻接（混合邻接）：如果q在集合$N_4(p)$中，或q在集合$N_8(p)$中，且集合$N_4(p)\cap N_4(q)$中没有来自V中数值的像素，则具有V中数值的两个像素p和q是m邻接的。

  引入m邻接是为了消除8邻接的歧义性。

- **连通（通路）**：设像素p（x，y）到q（s，t）的通路是如下的特定像素序列：
  $$
  (x_0,y_0),(x_1,y_1),...,(x_n,y_n)
  $$
  这里$(x_0,y_0)=(x,y),(x_n,y_n)=(s,t)$，并且像素$(x,y),(x_{i-1},y_{i-1})$是邻接的。此时，n是通路长度，可根据邻接类型定义4、8或m通路。

- 令S是图像中的一个像素子集。对于S中的任何像素p，S中连通到该像素的像素集称为S**的连通分量**。如果S仅有一个连通分量，则集合S称为**连通集**，也称S为一个**区域**。

- 区域R**边界**是这样的点集合：这些点与R的补集中的点邻近。

### 2.5.3 距离度量

对于坐标分别为(x,y)，(s,t)和(v,w)的像素p，q和z，如果：

- $D(p,q)\ge 0,\quad 当且仅当p=q时，D(p,q)=0$  两个像素之间的距离总是正的。
- $D(p,q)=D(q,p)$  距离与起终点的选择无关。
- $D(p,z)\le D(p,q)+D(q,z)$  最短距离是沿直线的。

则D是**距离函数或度量**。



1. 欧式距离：

$$
D_e(p,q)=[(x-s)^2+(y-t)^2]^{\frac{1}{2}}
$$
2. 距离D4（城市街区距离）：

$$
D_4(p,q)=|x-s|+|y-t|
$$
3. D8距离（棋盘距离）：

$$
D_8(p,q)=max(|x-s|,|y-t|)
$$
两点间的Dm距离用点间的最短通路定义，此时，两像素间的距离将依赖于**沿道路的像素值以内它们的邻点值**。如：

![3](数字图像.assets/3.PNG)



## 2.6 数字图像中的数学工具

### 阵列和矩阵操作

阵列乘法不同于矩阵乘法：

 ![1](数字图像.assets/1.PNG)



### 图像坐标变换

统一的矩阵表达形式

#### 平移变换 

$$
X^* = X + x_0 \\
Y^* = Y + y_0 \\
T = 
\left[
\begin{matrix}
1 & 0 & x_0  \\
0 & 1 & y_0 \\
0 & 0 & 1
\end{matrix}
\right] \\

\left[
\begin{matrix}
X^*  \\
Y^* 
\end{matrix}
\right] =
\left[
\begin{matrix}
1 & 0 & x_0  \\
0 & 1 & y_0 
\end{matrix}
\right] 
\left[
\begin{matrix}
X  \\
Y  \\
1
\end{matrix}
\right] \quad

\left[
\begin{matrix}
X^*  \\
Y^*  \\
1
\end{matrix}
\right] =
\left[
\begin{matrix}
1 & 0 & x_0  \\
0 & 1 & y_0  \\
0 & 0 & 1
\end{matrix}
\right] 
\left[
\begin{matrix}
X  \\
Y  \\
1
\end{matrix}
\right] \quad
$$

![](数字图像.assets/平移z.png)

![](数字图像.assets/平移矩阵.png)

#### 尺度(放缩)变换

$$
S =
\left[
\begin{matrix}
S_x & 0 & 0  \\
0 & S_y & 0  \\
0 & 0 & 1
\end{matrix}
\right]
$$

#### 旋转变换

$$
R =
\left[
\begin{matrix}
cos\gamma & sin\gamma & 0  \\
-sin\gamma & cos\gamma & 0  \\
0 & 0 & 1
\end{matrix}
\right]
$$

![](数字图像.assets/旋转.png)

#### 变换级连

对一个坐标为 v 的点的平移、放缩、绕 Z 轴旋转变换可表示为：
$$
v' = R_\gamma [S(Tv)] = Av
$$
用单个变换矩阵的方法可对点矩阵v 变换，这些矩阵的运算次序一般不可互换。

### 2.6.2 线性和非线性操作

![2](数字图像.assets/2.PNG)

### 2.6.3 算术操作

- 图像间的算术操作是阵列操作

#### 去除“叠加性”噪声

$$
对于原图像f(x,y)，有一个带噪声的图像集 {g_i(x,y)} i=1,2,\cdots,M\\
其中：g_i(x,y)=f(x,y)+h(x,y)_i\\
M个图像的均值定义为：\\
g(x,y) = \frac{1}{M}(g_0(x,y)+g_1(x,y)+\cdots+g_M(x,y))\\
前提：噪声h(x,y)_i为互不相关，且均值为0时，上述图像均值将降低噪声的影响。
$$



- 针对降噪的带噪图像相加（平均）**P.43 例2.5**

  ![4](数字图像.assets/4.PNG)

- 图像相减，增强图像之间的差别。

- 图像相乘或相除，可以校正阴影。

# 3 灰度变换与空间滤波

## 3.1 灰度变换和空间滤波基础

- 空间域：简单的包含图像像素的平面。

- **空间域技术**：灰度变换和空间滤波**直接对图像的像素**进行操作，属于空间域技术。空间域技术在计算上更有效，所需的处理资源更少。表示为：
  $$
  g(x,y)=T[f(x,y)]
  $$
  与频率域不同点在于：频率域在图像的傅里叶变换上执行，而不针对图像本身。

- **灰度变换**：灰度变换也称为灰度映射，就是将输入图像f(x,y)中的灰度r，通过映射函数T（·）映射成输出图像g(x,y)中的灰度s。

  - 灰度变换使得图像的灰度级得到拉伸，变换后的图像比原图像有更高的对比度，从而能显示更多细节。

## 3.3 直方图处理

- 直方图：
  - 是图像的一种统计表达，它描述了图像中各灰度值的像素个数，反映了该图中不同灰度级出现的统计概率。
  - 灰度级范围为[0,L-1]的数字图像的直方图是离散函数$h(r_k)=n_k，其中r_k是第k级灰度值，n_k是图像中灰度为r_k的像素个数$
  - 归一化直方图：$p(r_k)=n_k/MN$
    - $p(r_k)$是灰度级$r_k$在图像中出现的概率的一个估计
    - 归一化直方图的所有分量之和应为1
- PDF：概率密度函数
- 直方图在图像增强中的应用
  - 若一幅图像的像素倾向于占据整个可能的灰度级范围并且**分布均匀**，则该图像会有高对比度的外观并展示灰色调的较大变化，最终效果将是一幅**灰度细节丰富且清晰**的图像。
  - 一些图像由于其灰度分布集中在较窄的区间，对比度很弱，图像细节看不清楚。此时，可采用图像灰度直方图均衡化处理,使得图象的灰度分布趋向均匀，图像所占有的像素灰度间距拉开，加大了图像反差，改善视觉效果，达到增强目的。

### 3.3.1 直方图均衡

- 基本原理：把原始图像的直方图变换为均匀分布，以增加像素灰度值的动态范围，从而达到增强图像的目的。

$$
s_k=T(r_k)=(L-1)\sum^k_{j=0}p_r(r_j)=\frac{(L-1)}{MN}\sum^k_{j=0}n_j,k=0,1,2,...,L-1
$$

- $s_k$为均衡化后的灰度值，$r_j$为原图像的灰度值
- $T(r_k)$称为**直方图均衡**或**直方图线性变换**

## 3.4 灰度插值

图像的比例缩放、旋转变换时等，变换过程需要两个独立的算法：

1. 一个算法完成几何变换；
2. 一个算法用于灰度级插值；

数字图像处理只能对**坐标网格点(离散点)**的值进行变换。而坐标变换后产生的新坐标值同网格点值往往不重合，因此需要通过**内插**的方法将**非网格点**的灰度值变换为**网格点**的灰度值，这种算法称为灰度内插。

### 最邻近插值法

- 计算与$P(x_0, y_0)$临近的四个点；

- 将与点$P(x_0, y_0)$最近的整数坐标点(x,y)的灰度值取为$P(x_0, y_0)$点灰度近似值。

![](数字图像.assets/最近邻插值.png)

![](数字图像.assets/最近邻插值2.png)

### 双线性插值（一阶插值）

根据点$P(x_0, y_0)$的四个相邻点的灰度值，通过两次插值计算出灰度值$f(x_0, y_0)$。

![](数字图像.assets/双线性插值.png)

注意：X, Y平面点代表行列坐标，竖直线代表对应点的灰度值。

#### 公式

$$
\begin{align}
&f(x_0,y_0)\\
&=f(x,y)+\alpha[f(x+1,y)-f(x,y)]+\beta[f(x,y+1)-f(x,y)]\\
&+\alpha\beta[f(x+1,y+1)+f(x,y)-f(x,y+1)-f(x+1,y)]
\end{align}
$$

#### 特点

- 计算量大，但是缩放后图像质量高，不会出现图像不连续的情况。
- 具有低通滤波器的性质，使**高频分量减弱**，所以使图像的**轮廓在一定程度上受损**。

#### 对比

![](数字图像.assets/插值对比.png)

### 高阶插值

三阶插值：三次内插是指用(x,y)周围的16个网格点灰度按三次多项式进行内插的高精度算法。

## 3.5 空间滤波基础

- 空间滤波器由以下部分组成：
  - 一个领域（典型地是一个较小的矩形）
  - 对该邻域包围的图像像素执行的预定义操作
- 滤波产生一个新像素，新像素的坐标等于领域中心的坐标，像素的值是滤波操作的结果。
- 滤波器分为：
  - 线性空间滤波器：在图像像素上执行的是线性操作。
  - 非线性空间滤波器：在图像像素上执行的是非线性操作。

### 线性空域滤波的步骤

1. 将模版在图中漫游，并将模版中心与图中某个像素位置重合；
2. 将模版上系数与模版下对应图像相乘；
3. 将所有乘积相加；
4. 将**和**(模版的输出响应)赋给**图中对应模版中心位置**的像素。

## 3.6 平滑空间滤波器

- 用于模糊处理和降低噪声。

### 3.6.1 线性平滑滤波器

- 平滑线性滤波器的输出是：包含在滤波器模板邻域内的像素的简单平均值。也叫**均值滤波器**。（可以归入低通滤波器）
- 平滑滤波器：用滤波器模板确定的邻域内像素的平均灰度值代替图像中每个像素的值。
- 加权均值滤波器：模板并不是都为1
- 模板尺寸越大，图像越模糊，图像细节丢失越多。
- 应用：为了对感兴趣的物体得到一个粗略的描述而模糊一幅图像，使得较小物体的灰度就与背景混合在一起，而较大物体变得像“斑点”而易于检测。

#### 领域平均法

领域平均法：3X3均值平滑模版

- $$
  \frac{1}{9}
  \left[
  \begin{matrix}
  1 & 1 & 1  \\
  1 & 1 & 1  \\
  1 & 1 & 1
  \end{matrix}
  \right]
  $$

  ​	

#### 领域加权平均法

领域加权平均法：3X3加权均值平滑模版

- $$
  H_3=
  \frac{1}{9}
  \left[
  \begin{matrix}
  1 & 2 & 1  \\
  2 & 4 & 2  \\
  1 & 2 & 1
  \end{matrix}
  \right]
  $$





### 3.6.2 非线性平滑滤波器——统计排序滤波器

- 是一种非线性空间滤波器。
- 输出：以滤波器包围的图像区域中所包含的像素的排序（排队）为基础，然后使用统计排序结果决定的值**代替中心像素**的值。
- 常见：中值滤波器（对脉冲噪声（椒盐噪声）非常有效，这种噪声是以黑白点的形式叠加在图像上的）
- 在消除图像中噪声的同时能较好地保持图像中的细节。

#### 最大值滤波

- 主要用途：寻找最亮点
- 计算公式：$R=max\{z_k|k=1,2,\cdots\}$

#### 最小值滤波器
  - 主要用途：寻找最暗点
  - 计算公式：$R=min\{z_k|k=1,2,\cdots\}$
#### 中值滤波器

  - 钝化图像、去除噪音
  - 计算公式：$R=mid\{z_k|k=1,2,\cdots\}$

## 3.7 锐化空间滤波

- 主要目的：突出灰度的过渡部分。
- 锐化可用微分来完成，而微分算术的响应强度与图像在该点的突变成程度有关。
- 对一维函数，其一阶微分的基本定义：

$$
\frac{\partial f}{\partial x}=f(x+1)-f(x)
$$

- 二阶微分定义：
  $$
  \frac{\partial ^2f}{\partial x^2}=f(x+1)+f(x-1)-2f(x)
  $$






![3](D:/My%20Documents/Pan/%E6%AD%A6%E5%A4%A7/%E5%AD%A6%E4%B9%A0/Course/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86.assets/3.PNG)

- 一些结论：
  - 一阶微分产生的边缘宽（如：沿斜坡很长一段非0）
  - 二阶微分对细节反应强烈，如细线、孤立点（斜坡起止点为非0）
  - 一阶微分对灰度阶跃反应强烈
  - 二阶微分对灰度阶梯变化产生双响应，在大多数应用中，**对图像增强来说，二阶微分比一阶微分好一些**

### 3.7.2 使用二阶微分进行图像锐化——拉普拉斯算子

- 关注各向同性滤波器（响应与滤波器作用的图像的突变方向无关，即旋转不变的，即将原图像旋转后进行滤波处理给出的结果与先对图像滤波然后再旋转的结果相同）。

- 拉普拉斯算子是最简单的各向同性微分算子

- 一个二维图像函数的拉普拉斯算子定义为：
  $$
  \nabla ^2f=\frac{\partial^2f}{\partial x^2}+\frac{\partial ^2f}{\partial y^2}
  $$

  - 在x方向上：
    $$
    \frac{\partial ^2f}{\partial x^2}=f(x+1,y)+f(x-1,y)-2f(x,y)
    $$

  - 在y方向上：
    $$
    \frac{\partial ^2f}{\partial y^2}=f(x,y+1)+f(x,y-1)-2f(x,y)
    $$

  - 所以有：
    $$
    \nabla ^2f(x,y)=f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)
    $$








  该公式可以用下图的滤波模板来实现：（4邻域拉普拉斯模板）

  ![4](D:/My%20Documents/Pan/%E6%AD%A6%E5%A4%A7/%E5%AD%A6%E4%B9%A0/Course/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86.assets/4-1538051127689.PNG)

- 对45°增幅的结果是各向同性的：（8邻域拉普拉斯模板）
  $$
  \nabla ^2f(x,y)=f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)\\+f(x-1,y+1)+f(x+1,y+1)+f(x-1,y-1)+f(x+1,y-1)-8f(x,y)
  $$
  即下图模板：

  ![5](D:/My%20Documents/Pan/%E6%AD%A6%E5%A4%A7/%E5%AD%A6%E4%B9%A0/Course/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86.assets/5.PNG)

- 使用拉普拉斯对图像增强的基本方法可表示为：
  $$
  g(x,y)=f(x,y)+c[\nabla ^2f(x,y)]
  $$

  - 若模板中心为负数，则常数c=-1，否则c=1

- 图像相减时，可能出现负数，解决方案：（以0~255为例）

  - 方案一：每一像素+255，然后除以2
    - 优点：简单、快速
    - 缺点：无法保证覆盖0~255全范围
  - 方案二：先提取最小值取反后加在差图像中然后用乘每一像素可保证结果


### 3.7.3 使用一阶微分对（非线性）图像锐化——梯度法

- 对于函数$f(x,y)$，f在坐标(x,y)处的梯度定义为二维列向量：
  $$
  \nabla f=grad(f)=
  \left[
  \begin{aligned}
  g_x \\
  g_y
  \end{aligned}
  \right]
  =
  \left[
  \begin{align}
  \frac{\partial f}{\partial x} \\
  \frac{\partial f}{\partial y}
  \end{align}
  \right].
  $$

  - 该向量指出了在位置(x,y)处f的最大变化率的方向。

- 向量$\nabla f$的幅度值（长度）表示为M(x,y)，即
  $$
  M(x,y)=mag(\nabla f)=\sqrt{g_x^2+g_y^2}
  $$

  - 它是梯度向量方向变化率在(x,y)处的值。

  - M(x,y)是与原图像大小相同的图像，它是当x和y允许在f中的所有像素位置变化时产生的。该图像通常称为**梯度图像**（或含义很清楚时，可简称为**梯度**）

  - 为了减少计算量，用下式算近似：
    $$
    M(x,y)\approx |g_x|+|g_y|
    $$

    - 运算简单，但是各向同性就不存在了（只对90°才保持）

#### Roberts交叉梯度算子

- 令中心点$z_5$表示任意位置(x,y)处的$f(x,y)$，$z_1$表示为$f(x-1,y-1)$

- 在Roberts算子中：
  $$
  g_x=(z_9-z_5)和g_y=(z_8-z_6)
  $$

  - 可用以下模板实现：

    ![7](数字图像.assets/7.PNG)

- 梯度图像为：
  $$
  M(x,y)=[(z_9-z_5)^2+(z_8-z_6)^2]^{1/2}
  $$

- 简化运算为：
  $$
  M(x,y)\approx |z_9-z_5|+|z_8-z_6|
  $$








#### Soble算子

- 使用以$z_5$为中心的一个3*3邻域对$g_x$和$g_y$的近似如下：
  $$
  \begin{align}
  & g_x=\frac{\partial f}{\partial x}=(z_7+2z_8+z_9)-(z_1+2z_2+z_3) \\
  & 和 \\
  & g_y=\frac{\partial f}{\partial y}=(z_3+2z_6+z_9)-(z_1+2z_4+z_7)
  \end{align}
  $$
  ​	可用以下模板来实现：

  ​	![8](数字图像.assets/8.PNG)

- 中心系数使用权重2的思想是通过突出中心点的作用而达到平滑的目的。

- Roberts算子和Soble算子的模板中的系数总和为0，这正如微分算子的期望值那样，表明灰度恒定区域的响应为0

#### 应用

- 使用梯度可以进行边缘增强。



# 4 频率域滤波

**奈奎斯特采样定理**：

对一个有限带宽的连续信号进行采样，当采样频率**大于信号最高频率的两倍**时，可以由所获得的离散样本完全恢复原始的连续信号。

## 4.1 背景

- **域**：对信号的分析可以从不同的角度、采用不同的方式。每一种特定的角度以及对应的处理方法，就形成一个“域”。可以把“域”视为一个坐标系。
  - 时域：信号在时间轴上的变化，描述信号幅度和时间之间的关系，以时间作为变量。
  - 空间域：信号在空间坐标轴上的变化，描述信号幅度和x, y坐标轴之间的关系，以空间坐标作为变量。
  - 频域：信号在频率轴上的变化，描述信号幅度/相位和频率之间的关系，以频率作为变量。
- **傅里叶级数**：任何**周期函数**都可以表示为不同频率的正弦或余弦的和的形式。
  - 物理意义：
    - 周期信号可展开成直流和无穷多个频率为**基频整数倍**的、且具有不同**幅度**和**初相位**的正弦信号的叠加。
- **傅里叶变换**：对于**非周期函数**，则用正线和余弦及加权函数的**积分**来表示。


## 4.2 傅里叶变换

### 4.2.1 一维离散傅里叶变换（DFT）及其反变换

- **非周期离散信号**的DFT得到的频谱仍然是**离散**的。
- 每一根谱线代表对应谐波成分的强度。
- 变换长度不同，频谱包络相同。
- 变换长度越大，则谱线间隔越小，即谱线密度与变换长度成反比。

#### 离散变量函数

$$
\begin{aligned}
& F(u)=\frac{1}{M}\sum^{M-1}_{x=0}f(x)e^{-j2\pi ux/M}，\\
& 其中u=0,1,2,...,M-1 \\
& f(x)=\sum^{M-1}_{u=0}F(u)e^{j2\pi ux/M}， x=0,1,2,...,M-1
\end{aligned}
$$

#### 连续变量函数的傅立叶变换

$$
f(t)的傅里叶变换：F(\mu )=\int _{-\infty}^\infty f(t)e^{-j2\pi \mu t}dt \\
傅里叶反变换获得f(t)：f(t)=\int_{-\infty}^\infty F(\mu)e^{j2\pi \mu t}d\mu
$$

- 以上被称为傅里叶变换对。



### 4.2.2 二维傅里叶变换及其反变换

**==重点：直流分量==**

![5](数字图像.assets/5.PNG)

#### 二维DFT的性质

- **平移性**

  - 平移操作：

    ![1544236362373](数字图像.assets/1544236362373.png)

  - 空间位移：

    当空域信号f(x,y)产生移动时，在频域中只发生相移，并不影响其**傅里叶变换（F(x，y)）的幅度**。

  - 频率位移：

    当频域信号F(u,v)产生移动时，在空域中只发生相移，并不影其**反傅里叶变换（f(u,v)）的幅度**。

- **旋转性**

  当空域信号f(x,y)旋转一定角度时，频域信号F(u,v)也旋转相同的角度。

- **周期性**

  二维DFT及其逆变换都是以变换的点数为周期的。

- **共轭对称性**

  二维DFT是以原点为中心的共轭对称函数。

### 4.2.3 空间域滤波和频率域滤波之间的对应关系

离散卷积计算：图像区域和滤波器对应位置相乘，所求得结果相加后除以滤波器元素总数。

- 空间域和频率域中的滤波器组成了一个傅立叶变换对
- 一般空间域更适合使用小的滤波器。

## 4.3 频率域滤波基础

### 频域率滤波增强的原理

- 在频域空间，图像的信息表现为不同频率分量的组合。
- 频谱图像$|F(u,v)|$特点：
  - **低频**部分集中了大部分能量，对应于图像中灰度变化缓慢的区域。
  - **高频**部分对应边缘和噪声等**细节**内容，灰度发生急剧变化。
- **频域增强**是通过改变图像中**不同频率分量**来实现的。
- 频域增强的工具是**频域滤波器**，不同的滤波器滤除的频率和保留的频率不同，因而可获得不同的增强效果。

**为什么要做图像变换？**

- 变换后的图像，大部分能量都分布在低频谱段，这对以后图像的压缩、传输都比较有利。使得运算次数减少、节省时间。

![1544238731131](数字图像.assets/1544238731131.png)

### 频率域滤波操作

- 图像频率域滤波增强的一般步骤：
  - 将图像从图像空间转换到频域空间
    - 计算图像的傅里叶变换
  - 通过频域滤波方法对图像进行增强
    - 将图像的傅里叶谱与频域滤波器相乘
  - 将增强后的图像从频域空间转换到图像空间
    - 进行傅立叶反变换
- 基本步骤：
  - $(-1)^{x+y}\times 原图像$
  - 傅里叶变换得到：$F(x,y)$
  - $滤波器H(u,v)\times F(u,v)$
  - 反DEF操作，仅选择实部
  - $(-1)^{x+y}\times 上一步的结果$

## 4.4 频率域平滑滤波——低通滤波器

- 高频包含图像的边缘以及其他尖锐的灰度转变（如噪声）的信息，所以可以通过对高频进行衰减来使得频率域平滑（模糊），即使用低通滤波。

### 4.4.1 理想低通滤波器（ILPF）

- “理想”是指小于截止频率$D_0$的频率可以完全不受影响地通过滤波器，而大于$D_{0}$的频率则完全通不过。

- 函数：
  $$
  H(u,v)=
  \left\{
  \begin{aligned}
  1,\quad D(u,v)\le D_0 \\
  0,\quad D(u,v)>D_0
  \end{aligned}
  \right. \\
  D(u,v)是F(u,v)到频率矩形中心的距离
  $$
  表示，在以原点为圆心，以$D_{0}$为半径的圆内，无衰减地通过所有频率，其余的都消除。

- 缺点：容易出现“振铃”现象（指输出图像的灰度剧烈变化处产生的震荡，就好像钟被敲击后产生的空气震荡、波纹）

![1544240971481](数字图像.assets/1544240971481.png)



### 4.4.2 布特沃斯低通滤波器（Butterworth, BLPF）

- 函数：
  $$
  H(u,v)=\frac{1}{1+[D(u,v)/D_0]^{2n}} \\
  n:滤波器的阶数
  $$







- 与理想低通滤波器ILPF相比：
  - 没有明显的跳跃
  - 模糊程度降低
- 特点：
  - 一阶BLPF没有振铃显现，但随着阶数的增加，振铃现象会变得越来越明显
  - 对图像的平滑效果不如理想滤波器

![1544240980919](数字图像.assets/1544240980919.png)



### 4.4.3 高斯低通滤波器（GLPF）

- 函数：
  $$
  H(u,v)=e^{-D^2(u,v)/2\sigma^2} \\
  通常令\sigma=D_0
  $$

- 特点：

  - 没有振铃现象
  - 平滑效果不如前两种滤波器

![1544240992444](数字图像.assets/1544240992444.png)



## 4.5 频率域锐化滤波——高通滤波

- 低通滤波器的反操作。

- 一个高通滤波器是从给定的低通滤波器用下式得到：
  $$
  H_{HP}(u,v)=1-H_{LP}(u,v)
  $$









![1544240946572](数字图像.assets/1544240946572.png)

### 4.5.1 理想高通滤波器（IHPF）

- 函数：
  $$
  H(u,v)=
  \left\{
  \begin{aligned}
  0,\quad D(u,v)\le D_0 \\
  1,\quad D(u,v)>D_0
  \end{aligned}
  \right. \\
  $$







### 4.5.2 布特沃斯高通滤波器（BHPF）

- 函数：
  $$
  H(u,v)=\frac{1}{1+[D_0/D(u,v)]^{2n}} \\
  n:滤波器的阶数
  $$







### 4.5.3 高斯高通滤波器

- 函数：
  $$
  H(u,v)=1-e^{-D^2(u,v)/2\sigma^2} \\
  通常令\sigma=D_0
  $$







# 5 图像复原与重建（概念）

- **图像的退化**：图像在形成、存储和传输过程中，由于成像系统、传输介质和设备的不完善，使图像的质量变坏。
- **图像复原**：在研究图像退化原因的基础上，以退化图像为依据，根据一定的**先验知识**建立一个退化模型，然后做**相反的运算以恢复**原始景物图像。

## 5.1 图像退化/复原过程

- 空间域中的退化图像：
  $$
  g(x,y)=h(x,y)\bigstar f(x,y)+\eta(x,y) \\ 
  \bigstar表示空间卷积，h(x,y)为退化函数，\eta(x,y)为噪声函数
  $$

- 频率域中的退化图像：
  $$
  G(x,y)=H(u,v)F(u,v)+N(u,v)
  $$







### 最小均方误差复原法——Wiener滤波复原

Wiener滤波**综合考虑退化函数和噪声统计特征**，按照复原图像与原图像的**均方差最小原则**来恢复图像：

- 误差度量：$e^2 = E\{(f-\hat f)^2\}$  ，E{·}表示数学期望值。

- 目标：寻找一个滤波器，使得复原后图像$\hat f (x,y)$与原始图像$f(x,y)$的均方误差最小。
  $$
  E\{[\hat f(x,y)-f(x,y)]^2\} = min
  $$





因此维纳滤波复原又称为**最小均方误差(MSE)**复原。

# 6 彩色图像处理

## 6.1 彩色基础

### RGB彩色模型

- 三原色：红、绿、蓝
- 二次色：黄、青、品红
- 用红、绿、蓝三种颜色表示三维坐标系的坐标轴
- 用三维空间中的一个点的坐标来表示颜色

 ![](数字图像.assets/彩色.png)

### 其他彩色模型及应用

1. RGB（红、绿、蓝）彩色模型

   面向硬件，应用于彩色监视器、彩色摄像机等

2. CMY（青、品红、黄）彩色模型

   面向硬件，应用于彩色打印机

3. HIS（色调、明度、饱和度）彩色模型

   更符合人描述和解释颜色的方式，因而更广泛地应用于与人的视觉系统感知相关的图像表示和处理系统中，如目标分析、图像分割等。

# 8 图像压缩（重点）

## 哈夫曼编码（重点）

Huffman码表的建立步骤: 

1. 将信源符号按出现概率从大到小排成一列，然后把最末两个符号的 概率相加，合成一个概率。 

2. 把这个符号的概率与其余符号的概率按从大到小排列，然后再把最 末两个符号的概率加起来，合成一个概率。 

3. 重复上述做法，直到最后剩下两个概率为止。 

4. 从最后一步剩下的两个概率开始逐步向前进行编码。每步只需对两 

   个分支各赋予一个二进制码，如对概率大的赋予码0，对概率小的赋 

   予码1。 

## 算术编码（重点）

## 行程编码

- 连续的、具有相同灰度值的一些象素组成的序列称为一个行程。在编码时， 对于每个行程只存储一个灰度值的码，再紧跟着存储这个行程的长度。 

- 适用于有较多灰度相同对象的图像，例如海洋、湖泊的卫星图像，医学图像 中的细胞，染色体，材料的显微图像等。 

## 块变换编码

- 块变换编码：把图像分成大小相等且不重叠的小块，对每块单独进行编码。![](数字图像.assets/块变换编码1.png)

- 编码过程：![](数字图像.assets/块变换编码2.png)

## JPEG压缩编码图（重点）

![jpeg1](数字图像.assets/jpeg1.png)

![jpeg2](数字图像.assets/jpeg2.png)

### 主要计算步骤 

1. 正向离散余弦变换(FDCT)
2. 量化(quantization) (这一步出现了信息的损失) 
3. Z字形编码(Zigzag scan)。 
4. 使用差分脉冲编码调制(DPCM)对直流系数(DC)进行编码 
5. 使用行程长度编码(RLE)对交流系数(AC)进行编码 
6. 熵编码(entropy coding) 

# 9 形态学图像处理（重点）

## 预备知识

反射与平移广泛用来表达基于结构元的操作。

### 反射

集合B的反射$\hat B$：定义为$\hat B = \{w|w=-b,b \in B\}$，即关于原集合原点对称。

### 平移

集合A的平移$A_z$：集合A平移到点$z=(z_1,z_2)$，表示为$A_z$，定义为$A_z=\{c|c=a+z,a\in A\}$。

![](数字图像.assets/反射平移.png)

### 击中与击不中

设有两幅图像A和B，如果$A\cap B \ne \varnothing$，那么称B击中A，记为$B\uparrow A$；否则如果$A\cap B = \varnothing$，那么称B击不中A。（通常A为背景、B为前景）

![](数字图像.assets/击中.png)

### 二值图像逻辑操作

![](数字图像.assets/逻辑操作.png)

## 腐蚀与膨胀（重点）

### 结构元

**结构元**：研究一幅图像中感兴趣特性所使用的小集合或子图像。

结构元通常关于原点元素对称，且成矩形阵列。

- 二值形态学中的运算对象是集合。设A为图像集合，S为结构元，形态学运算就是**用S对A进行操作**。
- **实际上结构元本身也是一个图像集合**。对每个结构元可以指定一个**原点**，它是结构元素参与形态学运算的**参考点**。
- 应注意，**原点可以包含在结构元中，也可以不包含在结构元**中，但**运算的结果常不相同**。
- 二值形态学中两个最基本的运算是腐蚀与膨胀。

![结构元](数字图像.assets/结构元.png)

### 腐蚀

使图像缩小。

#### 定义

假定A和B是$Z^2$上的两个集合，A被B腐蚀定义为：
$$
A \ominus B = \{z|(B)_z \subseteq A\}
$$
集合B称为结构元。

A被B腐蚀的结果是所有使B平移Z后仍在A中的元素的集合。

==换句话说，用B来腐蚀A得到的集合是*B中元素完全包括在A中时***B的原点位置的集合**。==

#### 运算原理示例

![腐蚀](数字图像.assets/腐蚀.png)

#### 算法

1. 用结构元素B(如3x3)，扫描图像A的每一个像素。
2. 用**结构元素**与其**覆盖的二值图像**做**“与”操作**。
3. 再根据计算的结果**对结构元素原点对应的图像象素置值**。
4. 如果**都为1**（结构相同），结果**图像中与B的原点位置对应的像素值标注为1**；否则为0。

#### 应用

- 腐蚀在数学形态学运算中的作用是**消除物体边界点**。
- 如果结构元素取3×3的像素块，腐蚀将使物体的边界沿周边减少一个像素。



1. 腐蚀可以把小于结构元素的物体(毛刺、小凸起)去除，这样选取不同大小的结构元素，就可以在原图像中去掉不同大小的物体。产生滤波器的作用。

2. 消除物体边界点：如果两个物体之间有细小的连通，那么当结构元素足够大时， 通过腐蚀运算可以将两个物体分开。

### 膨胀

使图像扩大。

#### 定义

A和B是$Z^2$中的集合，A被B膨胀定义为：
$$
A \oplus B = \{z|(\hat B)_z \cap A \ne \varnothing)\}\\
或\\
A \oplus B = \{z|[(\hat B)_z \cap A] \subseteq A)\}
$$
集合B通常叫做膨胀结构元。

- 上式表示：B的反射进行平移与A的交集不为空；
-  B的反射：相对于自身原点的映象；

- **注意：是B的反射进行操作。**

#### 运算原理示例

B膨胀A的过程：先对结构元素B做关于原点的映射 $\hat B$ ，再将 $\hat B$  平移z， $\hat B$和A至少有1个非零元素相交时**B的原点位置的集合**。

![膨胀](数字图像.assets/膨胀.png)

![膨胀2](数字图像.assets/膨胀2.png)

#### 算法

1. 将结构元素**B反射后的原点**移至集合A的某一点；
2. 用结构元素与其覆盖的二值图像做**“或”操作**；
3. 再据计算结果对**结构元原点对应的图像象素置值**；
4. 如果**都为0，结果图像该像素为0**，否则为1；
5. 对集合中所有元素重复该过程。

#### 应用

1. 将裂缝接起来的形态学膨胀。
2. 和腐蚀一起使用，可以做到图形筛选：先腐蚀去掉不要的，再膨胀恢复所需要的。

#### 对偶性

膨胀和腐蚀彼此关于集合求补运算和反射运算是对偶的，即：
$$
(A \ominus B )^C = A^C \oplus \hat B \\
(A \oplus B )^C = A^C \ominus \hat B \\
$$

## 开操作和闭操作（重点）

### 开操作

**先用B对A进行腐蚀，然后用B对结果膨胀。**

开操作作用：使图像的轮廓变得光滑，断开狭窄的间断和消除细的突出物。

#### 定义

使用结构元素B对集合A进行开操作，定义为：
$$
A \circ B = (A\ominus B)⊕ B
$$
含义：先用B对A腐蚀，然后用B对结果膨胀。

另一个定义：
$$
  A\circ B = ∪\{(B)_z| (B)_z ⊆ A\}
$$

#### 几何解释

- $A\circ B$的边界通过B中的点完成；
-  **B在A的边界内转动时，B中的点所能到达的A的边界的最远点**。
- ![开操作](数字图像.assets/开操作.png)

#### 示例

![开操作示例](数字图像.assets/开操作示例.png)

#### 性质

1. $A\circ B$是A的子集合；
2. 如果C是D的子集，则$C\circ B$是$D\circ B$的子集；
3. $(A\circ B) \circ B= A \circ B$；

### 闭操作

**先用B对A膨胀，然后用B对结果腐蚀。**

闭操作作用：同样使图像的轮廓变得光滑，但与开操作相反，它用来填充物体内细小空洞、连接邻近物体、平滑其边界的同时并不明显改变其面积。

#### 定义

使用结构元素B对集合A进行闭操作，定义为：
$$
A\bullet B = (A⊕ B)\ominus B \\
或\\
A\bullet B = \cup\{(B)_z|(B)_z \cap A \ne \varnothing\}
$$
含义：先用B对A膨胀，然后用B对结果腐蚀。

#### 几何解释

- AoB的边界通过B中的点完成；
- B在A的边界外转动时，B中的点所能到达的A的边界的最远点。
- ![闭操作几何解释](数字图像.assets/闭操作几何解释.png)

#### 示例

![闭操作示例](数字图像.assets/闭操作示例.png)

#### 性质

1. A是A•B的子集合；
2. 如果C是D的子集，则C•B是D•B的子集；
3. (A•B)•B= A•B

### 开操作和闭操作联合应用

应用：先开操作再闭操作，构成噪声滤波器。

![开闭操作](数字图像.assets/开闭操作.png)

1. a图是受噪声污染的指纹二值图像，噪声为黑色背景上的亮元素和亮指纹部分的暗元素。

2. b图是使用的结构元素。

3. c图是使用结构元素对图a腐蚀的结果：黑色背景噪声消除了，指纹中的噪声尺寸增加。

4. d图是用结构元对图c膨胀的结果：包含于指纹中的噪声分量的尺寸被减小或被完全消除，但在指纹纹路间产生了新的间断。

5. e图是对图d膨胀的结果，图d的大部分间断被恢复，但指纹的线路变粗了。

6. f图是对图e腐蚀的结果，即对图d中开操作的闭操作。最后结果消除了噪声斑点。

## 其他·待定



# 10 图像分割和边缘检测（重点）

## 基本知识

- 图像分割的目标是重点根据图像中的物体将图像的像素分类，并提取感兴趣目标。
- 图像分割是图像识别和图像理解的基本前提步骤。
- 针对单色图像的分割算法基于处理灰度值的两类特性之一：不连续性和相似性。
- 分类—分割依据：
  - **相似性分割**——区域：将相似灰度级的像素聚集在一起。形成图像中的不同区域。这种基于相似性原理的方法也称为**基于区域相关**的分割技术。
  - **非连续性分割**——边界：首先检测局部不连续性，然后将它们连接起来形成边界，这些边界把图像分以不同的区域。这种基于不连续性原理检出物体边缘的方法称为**基于点相关**的分割技术。
  - 两种方法是互补的。有时将它们结合起来，以求得到更好的分割效果。
- 图像分割的基本策略是基于灰度值的两个基本特性：
  - 区域之间的不连续性：
    - 先找到点、线（宽度为1）、边（不定宽度）
    - 再确定区域
  - 区域内部的相似性
    - 通过选择阈值，找到灰度值相似的区域
    - 区域的外轮廓就是对象的边

## 边缘检测

### 点检测

- 用空域的高通滤波器来检测孤立点

![](数字图像.assets/点检测.png)

- 若 R = 0 说明被检测区域各点灰度值相同。
- 若 R > T 说明被检测区域响应该高通滤波器，即该检测区域有孤立点。

### 线检测

- 通过比较典型模版的计算值，确认一个点是否在某个方向的线上。

- 设计模版：

  - 模版系数之和为0
  - 感兴趣的方向系数值较大

  ![](数字图像.assets/线检测.png)

- 用不同模版分别计算，从这些值中寻找绝对值最大值，确定当前点更加接近于该模版所对应的直线。

### 边缘检测

- 物体的边缘是以图像局部特性的不连续性的形式出现的，从本质上说，边缘意味着一个区域的终结和另一个区域的开始。
- 图像边缘信息在图像分析和人的视觉中都是十分重要的，是图像识别中提取图像特征的一个重要属性。

#### 边缘导数

边缘上的这种变化可以通过微分算子进行检测：

##### 一阶导数

$$
\frac{\partial f}{\partial x}=f(x+1)-f(x)
$$



- 通过梯度进行计算
- 特点：对于亮的边，边的变化起点是正的，结束是负的。对于暗边，结论相反。常数部分为零。
- 用途：用于检测图像中边的存在。

##### 二阶导数

- 一个二维图像函数的拉普拉斯算子定义为：
  $$
  \nabla ^2f=\frac{\partial^2f}{\partial x^2}+\frac{\partial ^2f}{\partial y^2}
  $$

  - 在x方向上：
    $$
    \frac{\partial ^2f}{\partial x^2}=f(x+1,y)+f(x-1,y)-2f(x,y)
    $$

  - 在y方向上：
    $$
    \frac{\partial ^2f}{\partial y^2}=f(x,y+1)+f(x,y-1)-2f(x,y)
    $$

  - 所以有：
    $$
    \nabla ^2f(x,y)=f(x+1,y)+f(x-1,y)+f(x,y+1)+f(x,y-1)-4f(x,y)
    $$



- 通过拉普拉斯算子来计算

![](数字图像.assets/边缘导数.png)

#### 简单边缘检测方法

- 最早的边缘检测方法都是基于像素的数值导数的，在数字图像中应用差分代替导数运算。

- 差分定义：
  $$
  \Delta_xf(i,j)=f(i,j)-f(i-1,j)\\
  \Delta_yf(i,j)=f(i,j)-f(i,j-1)\\
  $$



- 即使用一阶导数的边缘检测滤波器。

#### 边缘检测问题

- 问题：
  - 图像中存在太多的细节。
  - 图像受到噪声的干扰，不能准确的检测边缘。
- 一个解决方法：在边缘检测之前对图像进行平滑。先用高斯函数进行平滑（对图像进行线性平滑，在数学上是进行卷积）再提出用拉普拉斯算子来代替以减少后期的运算量。

#### Laplacian边缘检测

Laplacian边缘检测——即高斯拉普拉斯(Laplacian of Gaussian，LOG，或Mexican hat，墨西哥草帽 )滤波器。

- Laplacian由于对噪声太敏感，因此一般不单独使用，通常和平滑(Gaussian)高斯滤波器进行结合来进行边缘检测，**即高斯拉普拉斯(Laplacian of Gaussian，LOG，或Mexican hat，墨西哥草帽 )滤波器。**

  ![](数字图像.assets/高斯拉普拉斯.png)

### Hough变换

Hough(霍夫)变换可以用于将边缘像素连接起来得到边界曲线，它的主要优点在于受噪声和曲线间断的影响较小。

![hough](数字图像.assets/hough.png)

![hough2](数字图像.assets/hough2.png)

![hough3](数字图像.assets/hough3.png)

## 图像分割

### 阈值法

- 图像分割的的经典方法是基于灰度阈值的分割方法。


![阈值1](数字图像.assets/阈值1.png)

#### 全局阈值

- 全局阈值是指整幅图像使用同一个阈值做分割处理，并产生一个二值图，区分出前景对象和背景。
- 适用于背景和前景对比度大的图像
- 算法实现：
  - 选取一个合适的阈值T，逐行扫描图像
  - 凡灰度级大于T的，颜色置为255；凡灰度级小于T的，颜色置为0。
- 如何选取阈值，以下有人工和自动选取两种方式。

##### 人工阈值

通过人眼的观察，在分析图像直方图的基础上，人工选出合适的阈值。也可也在人工选出阈值后，根据分割效果，不断地交互操作，从而选择出最佳的阈值。

##### 自动阈值——迭代法

- 开始时选择一个阈值作为初始估计值，然后按某种策略不断选择新的阈值。

- 关键在于选什么样的阈值改进策略，好的阈值改进策略应该具备两个特征，一是能够快速收敛，二是在每一次迭代过程中，新产生阈值优于上一次的阈值。

- 基本全局阈值T可以按如下计算：

  ![](数字图像.assets/自动阈值-迭代.png)

##### 自动阈值——OSTU方法

![](数字图像.assets/ostu.png)

#### 单值阈值的问题

- 只能对双峰的直方图有较好的工作效果。
- 对于其他类型的直方图，需要更多的阈值。
- 不均匀的光照会使单值阈值方案失效。

#### 自动阈值——分水岭算法

![](数字图像.assets/分水岭1.png)

![](数字图像.assets/分水岭2.png)

![](数字图像.assets/分水岭3.png)

![](数字图像.assets/分水岭4.png)

- 改进的分水岭算法：

  ![](数字图像.assets/分水岭5.png)

### 区域分割

- 阈值分割法由于没有或很少考虑空间关系，使多阈值选择受到限制
- 基于区域的分割方法可以弥补，它利用的是图像的空间性质，该方法认为分割出来的属性同一区域的像素应具有相似的性质。
- 传统的区域分割算法有区域增长法和区域分割合并法。该类方法在没有先验知识可以利用时，对含有复杂场景或自然景物等先验知识不足的图像进行分割，也可以取得较好的性能。但是，空间和时间开销都比较大。

#### 区域生长

分割的目的是把一副图像划分成一些区域，最直接的方法就是把一幅图像分成满足某种判据的区域，即将点组成区域。为了实现分组，首先要确定区域的数目，其次要确定一个区域与其他区域相区别的特征，最后还要产生有意义分割的相似性判据。

##### 基本思路

![](数字图像.assets/区域生长.png)

##### 基本步骤

1. 选择合适的种子点
2. 确定相似性准则（生长准则）
3. 确定生长停止条件

##### 过程

- 从满足检测准则的点开始（或者已知点）在各个方向上生长出区域。
- 例如：每一步所接受的邻近点的灰度级与种子点的灰度级**相差绝对值小于等于T**。

![](数字图像.assets/区域生长2.png)